\chapter{Esquemas}

\section{El espectro de un anillo}

\begin{mydefi}
	Sea $A$ un anillo.%
	\footnote{En éste libro todos los anillos se suponen conmutativos y unitarios.}
	Llamamos su \strong{espectro primo}\index{espectro!primo} (resp. \strong{espectro maximal}\index{espectro!maximal}),
	denotado $\Spec A$ (resp. $\mSpec A$), al conjunto de sus ideales primos (resp. ideales maximales).
\end{mydefi}

En la geometría algebraica moderna se piensa en el espectro no sólo como una colección de ideales,
sino también como \textit{puntos} de un \textit{espacio} a los cuales podemos someter a ecuaciones.
De ese modo, dado un ideal primo $\mathfrak{p} \nsl A$, denotaremos por $x_{\mathfrak{p}}$ al mismo ideal pero pensado como un punto,
o viceversa, dado un punto $x \in \Spec A$ denotaremos por $\mathfrak{p}_x$ al mismo punto pensado como un ideal.

Bajo ésta perspectiva, un elemento $f \in A$ es una función sobre $\Spec A$,
donde a todo punto $x \in \Spec A$ le asocia $f(x) := f \bmod{\mathfrak{p}_x} \in A/\mathfrak{p}_x$.
Entonces, podemos preguntarnos ¿cuándo $f (x)$ se anula?
Y, por definición, ello equivale a preguntarse si $f \in \mathfrak{p}_x$. Se verifica lo siguiente:
\begin{enumerate}
	\item La función $0 \in A$ se anula en todo punto $x \in \Spec A$.
	\item Si dos funciones se anulan en $x$, entonces su suma también.
	\item Si una función se anula en $x$, entonces sus múltiplos también.
	\item Si un producto de funciones se anula en $x$, entonces alguna debe anularse en $x$.
\end{enumerate}

\begin{mydef}
	Dado un conjunto de funciones $S \subseteq A$ se define su \textit{lugar de ceros} como todos los puntos en donde se anula:
	$$ \VV(S) := \{ x \in \Spec A : \forall f \in S \quad f (x) = 0 \} = \{ x \in \Spec A : S \subseteq \mathfrak{p}_x \}. $$
\end{mydef}
\begin{ex}
	Fijemos $A = \Z$. Ahora, podemos pensar el 6 como función y notamos que el 6 sólo se anula en $x_2$ y $x_3$. Luego:
	$$ \VV(6) = \{ x_2, x_3 \}. $$
\end{ex}

\begin{lem}
	Dado un anillo $A$ se cumple:
	\begin{enumerate}
		\item Si $S_1 \subseteq S_2 \subseteq A$, entonces $\VV(S_1) \supseteq \VV(S_2)$.
		\item Si $\mathfrak{a} = (S)$ es el ideal generado por $S$, entonces $\VV(S) = \VV(\mathfrak{a})$.
		\item $\VV(1) = \emptyset$ y $\VV(0) = \Spec A$.
		\item Si $\{ \mathfrak{a}_i \}_{i\in I}$ es una familia de ideales de $A$, entonces:
			$$ \bigcap_{i\in I} \VV(\mathfrak{a}_i) = \VV\left( \bigcup_{i\in I} \mathfrak{a}_i \right)
			= \VV\left( \sum_{i\in I} \mathfrak{a}_i \right). $$
		\item Dados $\mathfrak{a, b} \nsle A$, entonces
			$$ \VV(\mathfrak{a}) \cup \VV(\mathfrak{b}) = \VV(\mathfrak{a \cap b}) = \VV(\mathfrak{a \cdot b}). $$
	\end{enumerate}
\end{lem}

\begin{mydef}
	Los conjuntos de la forma $\VV(\mathfrak{a})$ son exactamente los cerrados de una única topología sobre $\Spec A$,
	llamada la \strong{topología de Zariski}\index{topología!de Zariski}.
\end{mydef}
\begin{ex}
	\begin{itemize}
		\item Por un teorema de Krull, todo anillo no nulo posee un ideal maximal, en particular, un ideal primo.
			Luego $\Spec A = \emptyset$ syss $A = 0$.
		\item Si $A = k$ es un cuerpo, entonces sus ideales son solo $\{ (0), A \}$, por lo que, $\Spec k = \{ (0) \}$ y
			necesariamente adquiere la topología discreta.
		\item Sea $A := k[\varepsilon]/(\varepsilon^2)$, donde $\varepsilon$ es una indeterminada.
			Trivialmente existe una proyección $k[\varepsilon] \epicto A$ que prueba que el único ideal primo de $A$ es
			$(\varepsilon)$; nótese que ni siquiera $(0)$ es primo, pues $\varepsilon \cdot \varepsilon = 0$.
			Así $\Spec A$ es un punto, incluso cuando $A$ no es un cuerpo.
	\end{itemize}
\end{ex}

Para todo $f \in A$ denotamos
$$ \DD(f) := \Spec A \setminus \VV(f) = \{ x \in \Spec A : f \notin \mathfrak{p}_x \}. $$
Compare los dos últimos resultados con el primer capítulo.
\begin{prop}
	Los abiertos de la forma $\DD(f)$ con $f \in A$ forman una base de $\Spec(A)$.
\end{prop}
\begin{prob}
	Describir $\Spec\Z$ como espacio topológico.
\end{prob}

\begin{mydef}
	Dado $X \subseteq \Spec A$ podemos definir:
	$$ \II(X) := \{ f \in A : \forall x \in X \; f(x) = 0 \} = \{ f \in A : \forall x \in X \; f \in \mathfrak{p}_x \} = \bigcap_{x\in X} \mathfrak{p}_x. $$
\end{mydef}

\begin{prop}
	Dado un anillo $A$ y $X \subseteq Y \subseteq \Spec A$ se cumple:
	\begin{enumerate}
		\item $\II(X)$ es un ideal radical.
		\item Si $X \subseteq Y \subseteq \Spec A$, entonces $\II(X) \supseteq \II(Y)$.
		\item $\II(\Spec A) = \nilrad$ e $\II(\emptyset) = A$.
		\item Para todo $\mathfrak{a} \nsle A$ se cumple que $\mathfrak{a} \subseteq \II( \VV(\mathfrak{a}) )$.
		\item Para todo $X \subseteq \Spec A$ se cumple que $X \subseteq \VV( \II(X) )$.
	\end{enumerate}
\end{prop}

También hay resultados análogos al teorema de ceros de Hilbert, aunque aquí éstos resultan radicalmente más simples de probar:
\begin{thm}\label{thm:ring_nullstellensatz}
	Sea $A$ un anillo, se cumplen:
	\begin{enumerate}
		\item Sea $\mathfrak{a} \nsle A$, entonces $\II( \VV(\mathfrak{a}) ) = \rad\mathfrak{a}$ (cf. \cite{Alg}, Teo. 6.26).
		\item Sea $X \subseteq \Spec A$, entonces $\VV( \II(X) ) = X$ su clausura de Zariski.
	\end{enumerate}
\end{thm}
Los paralelos con la geometría algebraica clásica son evidentes.
El anillo $A$ se comporta como el álgebra polinomial $k[\vec x]$ mientras que el $\Spec A$ se comporta como el espacio afín $\A^n(k)$.
Veamos algunas propiedades de la topología del $\Spec A$:
\begin{cor}\label{thm:spec_closure}
	Sea $A$ un anillo y $X := \Spec A$. Entonces:
	\begin{enumerate}
		\item Para todo $x \in X$ se cumple que $\overline{\{ x \}} = \VV(\mathfrak{p}_x)$.
			Así pues, $y \in \overline{\{ x \}}$ syss $\mathfrak{p}_y \supseteq \mathfrak{p}_x$.
		\item Un punto $x \in X$ es cerrado syss $\mathfrak{p}_x$ es maximal.
	\end{enumerate}
\end{cor}

\begin{ex}
	Sea $k$ un cuerpo algebraicamente cerrado.
	Estudiemos $\Spec(k[x])$: como $k[x]$ es un DIP, entonces sus ideales primos son
	generados por polinomios irreducibles, o bien son el ideal nulo.
	Como $k$ es algebraicamente cerrado, entonces sus polinomios irreducibles son de la forma $x - \alpha$ para cada $\alpha \in k$.
	Los puntos $\mathfrak{p}_\alpha := (x - \alpha)$ son cerrados, pues son
	ideales maximales, pero el punto $\xi := (0)$ es tal que $\overline{\{ \xi \}} = \Spec(k[x])$.
\end{ex}
\begin{ex}
	En el $\Spec\Z$ sucede algo parecido.
	Los ideales de la forma $(p) =: x_p$ son maximales, luego los $x_p$'s son puntos cerrados, no obstante, el
	punto $\xi := (0)$ es denso.
	\todo{Rehacer figura de $\Spec\Z$.}
\end{ex}

% 2

% 3

% 5

% 7 11

% \Spec Z
% \xi

% Figura 3.1. Espectro de Z.
\begin{ex}
	Sea $A$ un dominio de valuación discreta, es decir, un anillo local que es DIP.
	Como es DIP, sus primos son o bien $(0) =: \xi$, o bien los maximales, pero como es local,
	sólo tiene un maximal $\mathfrak{m} =: s$.
	Así $\Spec A = \{ \xi, s \}$, donde $\xi$ es abierto (y denso), y $s$ es un punto cerrado.
	Topológicamente, $\Spec A$ es homeomorfo al espacio de Sierpiński (cfr. \cite{Top}, ej.~4).
\end{ex}
\begin{mydef}
	Sean $x, y \in X$ un par de puntos en un espacio topológico.
	Se dice que $y$ es una \strong{especialización}\index{especialización} de $x$, o que $x$ es una generización de $y$,
	denotado $x \speto y$, si $y \in \overline{\{ x \}}$.
	Se dice que $x$ es un \strong{punto genérico}\index{punto!genérico} si $z \speto x$ implica $z = x$.
\end{mydef}
Del ejemplo vemos que si $A$ es un dominio íntegro, entonces siempre el punto $\xi := (0)$ es genérico.
Más generalmente, en un espacio $T_0$, un punto denso es genérico.

\begin{prop}\label{thm:generic_in_spec}
	Sea $F \subseteq \Spec A$. Se cumplen:
	\begin{enumerate}
		\item Un cerrado $F \subseteq \Spec A$ es irreducible syss $\II(F)$ es un ideal primo.
		\item Un cerrado $F \subseteq \Spec A$ es una componente irreducible syss $\II(F)$ es un primo minimal.
		\item El espacio $\Spec A$ es irreducible syss posee un único primo minimal.
			En particular, el $\Spec A$ siempre es irreducible si $A$ es un dominio íntegro.
	\end{enumerate}
\end{prop}
\begin{cor}
	Sea $A$ un anillo arbitrario.
	Todo cerrado irreducible de $\Spec A$ admite exactamente un punto denso.
	En consecuente, existe una biyección entre cerrados irreducibles y puntos genéricos.
\end{cor}
\begin{proof}
	Sea $F$ un cerrado irreducible, entonces $\mathfrak{p} := \II(F)$ es un ideal primo por la proposición anterior.
	Luego claramente, $x_{\mathfrak{p}} \in \overline{\{ x_{\mathfrak{p}} \}} = \VV(\mathfrak{p}) = \VV(\II(F)) = F$.
	Para todo $y \in F$ se cumple que $\mathfrak{q}_y \subseteq \mathfrak{p}$, así que si $y = x_{\mathfrak{p}}$
	se cumple que $\mathfrak{q}_y \supset \mathfrak{p}$, y finalmente, $y \speto z$ syss $\mathfrak{q}_y \subseteq \mathfrak{q}_z$,
	por lo que, $y \not\speto x_{\mathfrak{p}}$.
\end{proof}
Los puntos genéricos serán de utilidad más adelante.

% La teoría de la dimensión en éste contexto da:
% \begin{prop}
% 	Sea $A$ un anillo.
% 	\begin{enumerate}
% 		\item $\dim(\Spec A) = \kdim A = \kdim(A/\nilrad)$.
% 		\item Para todo primo $\mathfrak{p} \nsl A$ se cumple que $\kdim(A_{\mathfrak{p}}) = \alt\mathfrak{p} = \codim(\VV(\mathfrak{p}), \Spec A)$.
% 		\item $\kdim A = \sup\{ \kdim(A_{\mathfrak{m}}) : \mathfrak{m} \in \mSpec A \}$.
% 	\end{enumerate}
% \end{prop}

\begin{thm}
	$\Spec A$ es compacto.
\end{thm}
\begin{proof}
	Sea $\{ U_i \}_{i\in I}$ un cubrimiento abierto de $\Spec A$ y elijamos suficientes $f_j \in A$ tales que $\DD(f_j) \subseteq U_i$ para algún $i \in I$
	y tal que ${ \DD(f_j) }_{j\in J}$ es un cubrimiento abierto de $\Spec A$ (lo cual es válido pues los $\DD(f_j)$'s son una base).
	El hecho de que $\Spec A = \bigcup_{j\in J} \DD(f_j)$ equivale a decir que el ideal generado por $\{ f_j \}_{j\in J}$ es $A$, luego existen
	$f_{j_1}, \dots, f_{j_n}$ y $a_{j_1}, \dots, a_{j_n} \in A$ tales que
	$$ a_{j_1} f_{j_1} + \cdots + a_{j_n} f_{j_n} = 1, $$
	de modo que $A = (f_{j_1}, \dots, f_{j_n})$ y $\Spec A = \bigcup_{\ell=1}^n \DD( f_{j_\ell} )$.
\end{proof}
\begin{thm}
	Si $A$ es un anillo noetheriano, entonces $\Spec A$ es noetheriano.
\end{thm}
El recíproco puede fallar.

\begin{cor}
	En un anillo noetheriano $A$, todo ideal radical $\mathfrak{r} \nsl A$ es una intersección de finitos ideales primos.
\end{cor}
\begin{prop}
	Dado un homomorfismo de anillos $\varphi \colon A \to B$, éste induce una aplicación (la contracción de ideales, cfr. \cite{Alg} \S6.1.3):
	\begin{multicols}{2}
		\begin{align*}
			\varphi^a \colon \Spec B &\longrightarrow \Spec A \\
			x &\longmapsto x^c = f^{-1}[\mathfrak{p}_x]
		\end{align*}
		\begin{center}
			\begin{tikzcd}
				A \dar["\varphi"', ""{name=s}] & \Spec A \\
				B                              & \Spec B \uar["\varphi^a"', ""{name=f}]
				\ar[from=s, to=f, Rightarrow, "\Spec"]
			\end{tikzcd}
		\end{center}
	\end{multicols}
	\begin{enumerate}
		\item $\varphi^a$ es continua. Más aún, $(-)^a \colon \mathsf{CRing} \to \mathsf{Top}$ es un funtor contravariante.
		\item Si $\varphi$ es suprayectiva, entonces $\varphi^a$ induce un homeomorfismo entre $\Spec B$ y el cerrado $\VV(\ker\varphi)$,
			luego $\varphi^a$ es un encaje (topológico) cerrado.
		\item Dado un ideal $\mathfrak{a} \nsl A$, entonces la proyección canónica $\pi \colon A \to A/\mathfrak{a}$ da lugar al encaje
			$\pi^a \colon \Spec(A/\mathfrak{a}) \to \Spec(A)$ que prueba que $\VV(\mathfrak{a})$ es homeomorfo a $\Spec(A/\mathfrak{a})$.
		\item Si $S$ es un sistema multiplicativo de $A$ que no contiene divisores de cero, entonces la inclusión $\lambda \colon A \to S^{-1}A$
			induce un homeomorfismo entre $\Spec(S^{-1} A)$ y $\{ \mathfrak{p} \in \Spec A : \mathfrak{p} \cap S = \emptyset \}$.
		\item En particular, dado $f \in A$, el abierto $\DD(f)$ con la topología subespacio de $\Spec A$ es homeomorfo al espacio $\Spec(A[1/f])$.
	\end{enumerate}
\end{prop}
\begin{proof}
	Probaremos la 2. Para ello, nótese que por el primer teorema de isomorfismos (cfr. \cite{Alg}, Teo. 2.23)
	se cumple que $\overline{\varphi}\colon A/\ker \varphi \to B$ es un isomorfismo, y los ideales primos de $A/\ker \varphi$ están en correspondencia con
	$\VV(\ker \varphi) \subseteq \Spec A$.
\end{proof}

Es sabido que la extensión de ideales no determina una función entre los espectros (dé un ejemplo).
El inciso 3 da el siguiente corolario:
\begin{cor}
	Dado un anillo $A$ se cumple que $\Spec A$ y $\Spec(A/\nilrad)$ son espacios topológicos homeomorfos.
\end{cor}
\begin{cor}
	Sea $\varphi \colon A \to B$ un homomorfismo de anillos.
	La función continua $\varphi^a \colon \Spec B \to \Spec A$ es dominante (i.e., su imagen es densa) syss $\ker \varphi$ es nilpotente.
	En particular, si $A$ es reducido, $\varphi^a$ es dominante syss $\varphi$ es monomorfismo.
\end{cor}
\begin{proof}
	Sabemos que la clausura de la imagen de $\varphi^a$ es $\VV(\ker \varphi) \subseteq \Spec A$.
	Así que, exigir que $\varphi^a$ sea dominante equivale a que $\VV(\ker\varphi) = \Spec A$, lo que equivale, por la proposición 3.8,
	a que $\ker\varphi \subseteq \nilrad$.
\end{proof}

\subsection{Espectro homogéneo}
\begin{mydef}
	Sea $A$ un anillo ($\N$-)graduado $A = \bigoplus_{d\in\N} A_d$ y recordemos que el ideal irrelevante es $A_+ := \bigoplus_{d > 0} A_d$.
	Llamamos su \strong{espectro homogéneo}\index{espectro!homogéneo}, denotado $\Proj A$, al conjunto de los ideal primos $\mathfrak{p} \nsl A$
	homogéneos tales que $\mathfrak{p} \nsupseteq A_+$, llamados \textit{primos relevantes}.

	Dado un conjunto $S \subseteq A$, definimos su lugar de ceros homogéneo:
	$$ \VV_+(S) := \{ x \in \Proj A : \forall f \in S \quad f (x) = 0 \} = \{ x \in \Proj A : \mathfrak{p}_x \supseteq S \}. $$
\end{mydef}

\addtocounter{thmi}{1}
\begin{slem}
	Dado un anillo graduado $A$ se cumple:
	\begin{enumerate}
		\item Si $S_1 \subseteq S_2 \subseteq A$, entonces $\VV_+(S_1) \supseteq \VV_+(S_2)$.
		\item Si $\mathfrak{a} = (S)^h$ es el ideal homogéneo generado por $S$, entonces $\VV_+(S) = \VV_+(\mathfrak{a})$.
		\item $\VV_+(1) = \VV_+(A_+) = \emptyset$ y $\VV_+(0) = \Proj A$.
		\item Si $\{ \mathfrak{a}_i \}_{i\in I}$ es una familia de ideales homogéneos de $A$, entonces:
			$$ \bigcap_{i\in I} \VV_+(\mathfrak{a}_i) = \VV_+\left( \bigcup_{i\in I} \mathfrak{a}_i \right)
			= \VV_+\left( \sum_{i\in I} \mathfrak{a}_i \right). $$
		\item Dados $\mathfrak{a, b} \nsle A$ homogéneos, entonces
			$$ \VV_+(\mathfrak{a}) \cup \VV_+(\mathfrak{b}) = \VV_+(\mathfrak{a \cap b}) = \VV_+(\mathfrak{a \cdot b}). $$
	\end{enumerate}
\end{slem}
\addtocounter{thmi}{-1}
\begin{mydef}
	Sea $A$ un anillo graduado y $\mathfrak{a} \nsle A$ un ideal.
	Se define su \strong{parte homogénea} como
	$$ \mathfrak{a}^h := \bigoplus_{d\in\N} (\mathfrak{a} \cap A_d) $$
	Es claro que a es homogéneo syss $\mathfrak{a} = \mathfrak{a}^h$.
\end{mydef}

\begin{lem}
	Sea $A$ un anillo graduado y $\mathfrak{p} \nsl A$ un primo.
	Entonces $\mathfrak{p}^h$ también es primo.
\end{lem}
\begin{proof}
	Sean $a, b \in A$ con descomposición homogénea:
	$$ a = \sum_{d=0}^{n} a_d, \qquad b = \sum_{d=0}^{m} b_d, $$
	tales que $ab \in \mathfrak{p}^h$, queremos probar que alguno está en $\mathfrak{p}^h$ .

	La prueba será por inducción fuerte sobre $n + m$.
	Si $n + m = 0$, entonces $a = a_0$, $b = b_0$ son homogéneos y trivialmente alguno está en $\mathfrak{p} \subseteq \mathfrak{p}^h$.
	Si no, su producto se escribe como 
	$$ a \cdot b = a_n b_m + \sum_{d=0}^{n+m-1} \sum_{i+j=d} a_i b_j. $$
	donde $a_i b_j$ es homogéneo de grado $< n + m$. Luego $a_n b_m \in \mathfrak{p} \cap A_{n+m}$,
	por lo que $a_n \in \mathfrak{p}$ o $b_m \in \mathfrak{p}$, sin perdida de generalidad supongamos el primer caso.
	Así $(a - a_n )b \in \mathfrak{p}^h$ y su descomposición homogénea llega hasta elementos de grado $< n + m$, luego o bien $a - a_n \in \mathfrak{p}^h$
	o $b \in \mathfrak{p}^h$ por hipótesis inductiva.
\end{proof}

\begin{prop}
	Sea $A$ un anillo graduado.
	\begin{enumerate}
		\item Si $\mathfrak{a, b} \nsle A$ son homogéneos, entonces $\VV_+(\mathfrak{a}) \subseteq \VV_+(\mathfrak{b})$
			syss $\mathfrak{b} \cap A_+ \subseteq \rad\mathfrak{a}$.
		\item $\Proj A = \emptyset$ syss $A_+$ es nilpotente.
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item $\impliedby.$ Sea $\mathfrak{p} \in \VV_+(\mathfrak{a})$, entonces $\mathfrak{p} \supseteq \rad\mathfrak{a}
			\supseteq \mathfrak{b} \cap A_+ \supseteq \mathfrak{b}$, por lo que $\mathfrak{p} \in \VV_+(\mathfrak{b})$.

			$\implies.$ Sea $\mathfrak{p} \in \VV(\mathfrak{a})$, entonces $\mathfrak{p}^h \supseteq \mathfrak{a}^h = \mathfrak{a}$.
			Si $\mathfrak{p}^h \nsupseteq A_+$, entonces $\mathfrak{p}^h \in \VV_+(\mathfrak{a}) \subseteq \VV_+(\mathfrak{b})$, luego
			$\mathfrak{p} \supseteq \mathfrak{p}^h \supseteq \mathfrak{b} \supseteq \mathfrak{b} \cap A_+$ y, por ende,
			$$ \mathfrak{b} \cap A_+ \subseteq \bigcap_{\mathfrak{p} \in \VV(\mathfrak{a})} \mathfrak{p} = \rad\mathfrak{a}. $$

		\item Si $\Proj A = \VV_+(0) \subseteq \VV_+(A_+) = \emptyset$, entonces $A_+ \subseteq \rad(0) = \nilrad$. \qedhere
	\end{enumerate}
\end{proof}
\begin{mydef}
	Sea $A$ un anillo graduado y $f \in A$ homogéneo. Definimos $\DD_+(f) := \Proj A \setminus \VV_+(f)$.
\end{mydef}
Recuérdese que:
\begin{mydef}
	Sean $A, B$ un par de anillos graduados.
	Un \strong{homomorfismo de anillos graduados}\index{homomorfismo!de anillos graduados} de grado $r \ge 1$ es un
	homomorfismo de anillos $\varphi \colon A \to B$ tal que $\varphi[A_d] \subseteq B_{rd}$ para todo $d \in \N$.
\end{mydef}

\begin{prop}
	Sea $A$ un anillo graduado, $f \in A$ homogéneo de grado $r > 0$, sea $g \in A$ tal que $\DD_+(g) \subseteq \DD_+(f )$
	y sea $\alpha := g^r f^{-\deg g} \in A_{(f)}$. Entonces:
	\begin{enumerate}
		\item Existe un homeomorfismo $\theta \colon \DD_+(f ) \to \Spec(A_{(f)})$.
		\item $\theta[\DD_+(g)] = \DD(\alpha)$.
		\item Existe un homomorfismo canónico $A_{(f)} \to A_{(g)}$ e induce un isomorfismo $(A_{(f)} )[1/\alpha] \cong A_{(g)}$.
		\item Si $a$ es homogéneo en $A$, entonces $\theta[\VV_+(a) \cap \DD_+(f )] = \VV( \mathfrak{a}_{(f)} )$,
			donde $\mathfrak{a}_{(f)} := \mathfrak{a} A[1/f ] \cap A_{(f)}$.
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item[\rm 1. y 2.] Nótese que $\Proj A \subseteq \Spec A$ hereda la topología subespacio.
			La inclusión $\iota \colon A_{(f)} \to A[1/f ]$ induce la aplicación continua
			$\Spec(A[1/f ]) \approx \DD(f ) \to \Spec(A_{(f)})$ y definimos $\theta \colon \DD_+(f ) := \DD(f )\cap \Proj A \to \Spec(A_{(f)})$
			como su restricción.

			Veamos que $\theta$ es suprayectiva: Sea $\mathfrak{p} \in \Spec(A_{(f)} )$, entonces es fácil
			ver que $\mathfrak{q} := \rad(\mathfrak{p} A[1/f])$ es primo en $A[1/f]$.
			Nótese que $A[1/f]$ es una $A_{(f)}$-álgebra graduada en sentido canónico, donde los elementos homogéneos de grado $n$ son
			de la forma $bf^{-N}$ donde $b \in A$ es homogéneo de grado $\deg b = N r + n$.
			Así $\mathfrak{q}$ es un primo homogéneo de $A[1/f]$.
			Considere $\lambda \colon A \to A[1/f ]$ el homomorfismo canónico, entonces es un homomorfismo de anillos graduados,
			y así $\mathfrak{r} := \lambda^{-1}[\mathfrak{q}]$ es un primo homogéneo de $A$ y $\mathfrak{r} \in \DD_+(f)$.
			Finalmente, queda al lector probar que $\theta(\mathfrak{r}) = \mathfrak{p}$.

			Veamos que $\theta$ es inyectiva: Sean $\mathfrak{p}, \mathfrak{p}' \in \DD_+(f )$ tales que $(\mathfrak{p} A[1/f]) \cap A_{(f)}
			= (\mathfrak{p}' A[1/f ]) \cap A_{(f)}$, entonces para todo $b \in \mathfrak{p}$ homogéneo se cumple que
			$b^r f^{-\deg b} \in (\mathfrak{p}A[1/f]) \cap A_{(f)} \subseteq \mathfrak{p}' A[1/f]$ de modo que $b \in \mathfrak{p}'$
			y $\mathfrak{p \subseteq p}'$ y, por simetría, $\mathfrak{p = p}'$.

			Veamos que $\theta$ es abierta: Basta notar que $\theta[\DD_+(g)] = \DD(\alpha)$ (¿por qué?)
			y emplear que los abiertos principales son una base. Finalmente, toda
			biyección abierta y continua es un homeomorfismo.

		\item Como $\DD_+(g) \subseteq \DD_+(f )$, el lema anterior nos da que $\rad(g)\cap A_+ \supseteq (f)$,
			luego para todo $a \in A$ se cumple que $g^n = f a$ para algún $n \in \N$.
			En particular, fijemos $a$ homogéneo y así determinamos el homomorfismo $bf^{-N} \mapsto (ba^N)g^{-nN}$.
			Queda de ejercicio para el lector verificar que el homomorfismo está bien definido y que determina un homeomorfismo entre los espectros.
			\qedhere
	\end{enumerate}
\end{proof}

\begin{prop}\label{thm:proj_spec_morphisms}
	Dado un homomorfismo de anillos graduados $\varphi \colon A \to B$ con $M := (A_+)^e = \varphi[A_+]B$, éste induce una aplicación:
	\begin{align*}
		\varphi^a \colon \DD_+(M) &\longrightarrow \Proj A \\
		x &\longmapsto x^c = \varphi^{-1}[\mathfrak{p}_x]
	\end{align*}
	\begin{enumerate}
		\item $\varphi^a$ es continua.
		\item Si $\varphi$ es suprayectiva, entonces $\varphi^a$ induce un homeomorfismo entre $\DD_+(M)$ y el cerrado $\VV(\ker \varphi)$,
			luego $\varphi^a$ es un encaje cerrado.
		\item Sea $\mathfrak{a} \nsl A$ un ideal homogéneo, entonces la proyección canónica $\pi \colon A \to A/\mathfrak{a}$ da lugar al encaje
			$\pi^a \colon \Proj(A/\mathfrak{a}) \to \Proj(A)$ que prueba que $\VV_+(\mathfrak{a})$ es homeomorfo a $\Proj(A/\mathfrak{a})$.
		\item Si $S$ es un sistema multiplicativo de $A$ que no contiene divisores de cero, entonces la inclusión $\lambda \colon A \to A_{(S)}$
			induce un homeomorfismo entre $\Spec(A_{(S)})$ y ${ \mathfrak{p} \in \Proj A : \mathfrak{p} \cap S = \emptyset }$.
		\item En particular, dado $f \in A$ homogéneo, el abierto $\DD_+(f)$ con la topología subespacio de $\Proj A$
			es homeomorfo al espacio $\Spec(A_{(f)})$.
	\end{enumerate}
\end{prop}
Ojo que para el inciso 2 hay que verificar que $\pi[A_+] = (A/\mathfrak{a})_+$.

\section{Haces}
Comenzamos con las nociones de haces y espacios anillados.
En esencia, un haz determina una familia de funciones que tienen ciertas <<propiedades locales>> con respecto a un espacio topológico.
\begin{mydefi}
	Dado un espacio topológico $X$, un \strong{prehaz}\index{prehaz} es un funtor contravariante $\mathscr{F} \colon \Open(X) \to \catC$,
	donde $\catC$ es una categoría.
	Un prehaz de conjuntos, de grupos, de anillos, etc., es un prehaz donde $\catC$ es la categoría de conjuntos, de grupos, de anillos, etc.
	Si $\catC$ es una categoría concreta,%
	\footnote{Una categoría cuyos objetos son <<conjuntos con estructura>>.
	Formalmente, una categoría $\catC$ con un funtor fiel canónico $\catC \to \mathsf{Set}$ llamado funtor olvidadizo (cfr. \cite{CatTh}, def.~1.15).}
	diremos que $\mathscr{F}$ es un prehaz concreto y, entonces $\mathscr{F}(U)$ es un conjunto (con estructura)
	y sus elementos se denominan \strong{secciones}\index{sección} sobre $U$; también denotamos $\Gamma(U, F)$ al conjunto de secciones sobre $U$.
	Las secciones sobre $X$ se dice \strong{secciones globales}\index{sección!global}.

	En general, dados $U \subseteq V$ abiertos de $X$, denotamos por $\rho^V_U \colon \mathscr{F}(V) \to \mathscr{F}(U)$
	la imagen de la flecha de inclusión, a los que llamamos \strong{restricciones}.
	Dada una sección $s \in \mathscr{F}(V)$ solemos denotar $s|_U := \rho^V_U(s)$.
\end{mydefi}

\begin{mydef}
	Sea $X$ un espacio topológico y $\mathscr{F}$ un prehaz concreto sobre $X$.
	Se dice que una familia $(s_i \in \mathscr{F}(U_i))_{i\in I}$ de secciones es \strong{compatible}\index{compatible (familia de secciones)}
	si para todo $i, j \in I$ se cumple que $s_i|_{U_i\cap U_j} = s_j|_{U_i\cap U_j}$.

	Decimos que un prehaz concreto $\mathscr{F}$ sobre $X$ es un haz%
	\footnote{fr. \textit{faisceau}, eng. \textit{sheaf}.}
	si para toda familia $(x_i \in \mathscr{F}(U_i))_{i\in I}$ compatible existe un único elemento $x \in \mathfrak{F}\big( \bigcup_{i\in I} U_i \big)$
	tal que $x|_{U_i} = x_i$ para todo $i \in I$ (<<axioma de pegado>>).\index{axioma!de pegado}
\end{mydef}

\citeauthor{hartshorne:algebraic}~\cite{hartshorne:algebraic} trabaja exclusivamente con prehaces de grupos en donde la condición de unicidad la expresa
diciendo que si un elemento se restringe al 0 en todos los $U_i$ es porque dicho elemento es el 0.

Hay una manera de escribir la condición de ser haz mediante flechas:
Sea $\{ U_i \}_{i\in I}$ una familia de abiertos tal que $U = \bigcup_{i\in I} U_i$, entonces considere las siguientes flechas:
\begin{equation}
	\begin{tikzcd}[sep=large]
		\displaystyle
		\mathscr{F}(U) \rar["\alpha"] & \prod_{i\in I} \mathscr{F}(U_i) \rar["\beta", shift left] \rar["\gamma"', shift right] &
		\prod_{i, j\in I} \mathscr{F}(U_i \cap U_j)
	\end{tikzcd}
	\label{cd:sheaf_equalizer}
\end{equation}
donde
\begin{gather*}
	\alpha(s) = \big( \rho_{U_i}^U(s) \big)_{i\in I}, \qquad \beta\big( (s_i)_{i\in I} \big) = ( \rho_{U_i\cap U_j}^{U_i}(s_i) )_{i, j} \\
	\gamma\big( (s_i)_{i\in I} \big) = ( \rho_{U_i\cap U_j}^{U_j}(s_i) )_{i, j}.
\end{gather*}
Y exigimos que el ecualizador de $\beta, \gamma$ sea $\alpha$.
Efectivamente, que $\alpha \circ \beta = \alpha \circ \gamma$ es la condición que una familia de secciones sea compatible.
Ésta condición puede sonar un tanto complicada, pero nos permite definir la categoría de haces sobre una categoría cualquiera.
% además la sucesión exacta dada por \eqref{cd:sheaf_equalizer} será útil más adelante para algunos cálculos.

Podemos extraer el siguiente caso:
\begin{prop}
	Sea $X$ un espacio topológico y $\mathscr{F}$ un prehaz de $A$-módulos sobre $X$.
	Entonces $\mathscr{F}$ es un haz syss para cada $U$ abierto y cada cubrimiento $\bigcup_{i\in I} U_i = U$ la sucesión
	\begin{center}
		\begin{tikzcd}[sep=large]
			\displaystyle
			0 \rar & \mathscr{F}(U) \rar["\alpha"] & \prod_{i\in I} \mathscr{F}(U_i) \rar["\delta"] & \prod_{i, j\in I} \mathscr{F}(U_i \cap U_j)
		\end{tikzcd}
	\end{center}
	es exacta, donde:
	\[
		\alpha(s) = \big( \rho_{U_i}^U(s) \big)_{i\in I}, \qquad \delta\big( (s_i)_{i\in I} \big) = ( s_i|_{U_i\cap U_j} - s_j|_{U_i\cap U_j} )_{i, j}.
	\]
\end{prop}

\begin{prop}
	Sea $X$ un espacio topológico.
	Todo haz $\mathscr{F} \in \mathsf{Sh}(X; \catC)$ satisface que $\mathscr{F}(\emptyset)$ es un objeto final.
\end{prop}

\begin{prop}
	Sean $\catC$ una categoría y $F \colon \catC \to \mathsf{Set}$ un funtor tales que:
	\begin{enumerate}
		\item $F$ es fiel.
		\item $\catC$ es completa y $F$ preserva límites inversos.
		\item $F$ refleja isomorfismos.
	\end{enumerate}
	Entonces, para todo espacio topológico $X$ y todo prehaz $\mathscr{O}$ con codominio $\catC$ se cumple
	que $\mathscr{O}$ es un haz en $\catC$ syss $\mathscr{O \circ F}$ es un haz de conjuntos.
\end{prop}
\begin{proof}
	$\implies$. Claramente $\mathscr{O \circ F}$ es un prehaz de conjuntos y como los ecualizadores son límites inversos, entonces también es un haz.

	$\impliedby$. Si $\mathscr{O \circ F}$ es un haz de conjuntos, entonces para un cubrimiento $\{ U_i \}_{i\in I}$ de un abierto $U$,
	sea $E$ el ecualizador de las flechas $\beta, \gamma$ de \eqref{cd:sheaf_equalizer}.

	Por definición de prehaz, existe una única flecha $\mathscr{O}(U) \to E$.
	Aplicando el funtor $F$, obtenemos $F(\mathscr{O}(U)) \to F(E)$ y como $F$ preserva límites, entonces $F(E)$ también es un ecualizador,
	por lo que la flecha es un isomorfismo y como $F$ refleja isomorfismos, entonces $\mathscr{O}(U) \to E$ es un isomorfismo.
\end{proof}
En particular, las categorías $\mathsf{Grp, Ab, Mod}_A, \mathsf{Vect}_k, \mathsf{Ring, CAlg}_A$ con el funtor olvidadizo satisfacen las hipótesis anteriores,
así que tenemos un buen criterio para verificar que un prehaz es un haz.

\begin{mydef}
	Sea $X$ un espacio topológico y $\mathfrak{F}$ un prehaz concreto sobre $X$.
	Dado un punto $P \in X$ llamamos la \strong{fibra}\index{fibra!(prehaz)}%
	\footnote{fr. \textit{fibre}, eng. \textit{stalk}.}
	\nomenclature{$\mathscr{F}_P$}{Fibra del prehaz $\mathscr{F}$ en el punto $P \in X$}
	sobre $P$, al límite directo (si existe) $\mathscr{F}_P := \limdir_{U \in\Open(X)} \mathscr{F}(U)$.
	Los elementos de $\mathscr{F}_P$ se dicen \strong{gérmenes locales}%
	\footnote{fr. \textit{germe}.
		La terminología, acuñada por el mismo Grothendieck, refiere a una analogía con la agronomía:
		los haces son literalmente atados de tallos de heno, los cuales a su vez germitan de semillas.
	}
	\index{gérmen local} en $P$.

	Trivialmente para cada entorno $U$ de un punto $P$ existe una única flecha $\rho^U_P \in \Hom\big( \mathscr{F}(U), \mathscr{F}_P \big)$ que
	conmuta con todas las restricciones.
	Dada una sección $s \in \Gamma(U, \mathscr{F})$ se denota $s|_P := \rho^U_P(s)$.
	% y denotamos por $s|_P := \rho_P^U(s)$.
\end{mydef}
Si la categoría de codominio fuese, por ejemplo, cocompleta (i.e., admite límites directos de diagramas),
entonces siempre podríamos asegurar la existencia de fibras sobre los puntos;
pero en general no requerimos tanto, sino que podemos aprovecharnos de que $\Open_P(X)$ es una categoría filtrada.
Veamos una construcción:

\begin{prop}
	Si $X$ es un espacio topológico, $\mathscr{F}$ es un prehaz de conjuntos sobre $X$ y $x \in X$,
	entonces podemos considerar el conjunto $C := \bigcup_{x\in U} \{ U \} \times \mathscr{F}(U)$ y la relación:
	$$ (U, f) \sim (V, g) \iff \exists x \in W \subseteq U \cap V \quad f|_W = g|_W $$
	la cual es de equivalencia. Luego el conjunto cociente $C/\sim$ es la fibra $\mathscr{F}_x$ sobre $x$.
\end{prop}
Ésta misma construcción podemos aplicarla sobre un prehaz de grupos, de anillos, de $A$-módulos verificando también que la relación de equivalencia
conmuta con las operaciones requeridas; ésto se asemeja al lema 1.68.

\begin{ex}
	\begin{itemize}
		\item Dado un par de espacios topológicos $X, Y$, el funtor contravariante $\Hom{\mathsf{Top}}(-, Y) \colon \Open(X) \to \mathsf{Set}$ es
			un haz de conjuntos, llamado el \textit{haz de funciones continuas}, donde la restricción es la restricción usual de conjuntos.

			Más aún, si $Y$ es un grupo topológico (resp. anillo topológico, $A$-módulo topológico) entonces $\Hom(-, Y)$ es un
			haz de grupos (resp. anillos, $A$-módulos).

			Nótese que aquí, el axioma de pegado está satisfecho por el hecho de que pegar funciones continuas compatibles sigue siendo continua;
			por tanto, hasta cierto punto se debe entender que un haz es un funtor contravariante dado por una familia de funciones definidas por una
			propiedad <<local>>.

		\item Dado un par de variedades diferenciales $X, Y$, el funtor contravariante $\Hom_{\mathsf{Man}^\infty} (-, Y) \colon \Open(X) \to \mathsf{Set}$
			es un haz de conjuntos, llamado el \textit{haz de funciones diferenciables}, donde la restricción es la restricción usual de conjuntos.

			Más aún, si $Y$ es un grupo topológico (resp. anillo topológico, $A$-módulo topológico) entonces $\Hom(-, Y)$ es un haz de grupos
			(resp. anillos, $A$-módulos).

			Acá las fibras juegan un rol particular y se llaman \textit{gérmenes de funciones diferenciales} en un punto.

		\item Sea $X$ un espacio topológico arbitrario, $A$ un grupo abeliano arbitrario y $P \in X$ un punto fijo.
			El \textit{haz rascacielos} centrado en $P$ es el haz
			$$ A_X^P(U) :=
			\begin{cases}
				A, & P \in U \\
				0, & P \notin U
			\end{cases} $$
			donde dados $U \subseteq V$ la restricción $\rho^V_U$ es la identidad si $P \in U$ o el homomorfismo nulo si $P \notin U$.

			Las fibras del haz rascacielos son
			$$ A_{X, Q}^P(U) :=
			\begin{cases}
				A, & P     \speto Q \\
				0, & P \not\speto Q
			\end{cases} $$

		\item Sea $X$ un espacio topológico y $A$ un conjunto arbitrario.
			Se le llama el \strong{prehaz constante}\index{prehaz!constante} $A^-_X$ al prehaz de conjuntos que corresponde a un funtor constante.

			Éste prehaz no es (en general) un haz: en primer lugar, uno puede argumentar que para que sea un haz se debe dar que $A^-_X(\emptyset)$
			sea el objeto final de la categoría, y podemos admitir sin problemas dicha condición, pero aún así sigue fallando en general.
			Si $A$ tuviese, por ejemplo, más de un elemento, entonces bastaría encontrar dos secciones distintas definidas sobre abiertos disjuntos
			de $X$ para notar que no es un haz.
			Aquí todas las fibras son $A$.

		\item Sea $X$ un espacio topológico y $A$ un conjunto arbitrario.
			Se le llama el \strong{haz constante}\index{haz!constante} (¡no confundir con el prehaz constante!) $A^+_X$ al haz
			de conjuntos que corresponde al funtor contravariante $\Hom_{\mathsf{Top}}(X, A)$, donde $A$ está visto como un espacio topológico discreto.
	\end{itemize}
\end{ex}

Como los (pre)haces son funtores contravariantes tenemos lo siguiente:
\begin{mydef}
	Sea $X$ un espacio topológico y $\mathscr{F}, \mathscr{G}$ prehaces sobre $X$ con codominio $\catC$.
	Un \strong{morfismo de prehaces}\index{morfismo!de prehaces} $\alpha \colon \mathscr{F} \to \mathscr{G}$ es una transformación natural entre
	los funtores contravariantes, i.e., es una familia de flechas $\alpha(U) \in \Hom_{\catC}(\mathscr{F}(U), \mathscr{G}(U))$ tal que el siguiente
	diagrama siempre conmuta:
	\begin{center}
		\begin{tikzcd}[row sep=large]
			U \dar["\subseteq"', hook] & \mathscr{F}(U)              \rar["\alpha(U)"] & \mathscr{G}(U) \\
			V                          & \mathscr{F}(V) \uar["\rho"] \rar["\alpha(V)"] & \mathscr{G}(V) \uar["\rho"']
		\end{tikzcd}
	\end{center}
\end{mydef}

Con ésto tenemos que:
\begin{prop}
	Los prehaces (resp. haces) sobre un espacio topológico fijo $X$ con codominio fijo $\catC$ (como objetos)
	y los homomorfismos entre ellos (como flechas) conforman una categoría denotada $\mathsf{PSh}(X; \catC)$ (resp. $\mathsf{Sh}(X; \catC)$).
	Se obvia la categoría de codominio cuando $\catC = \mathsf{Ab}$.
\end{prop}
Es notorio que $\mathsf{PSh}(X; \catC)$ es la misma categoría que $\mathsf{Fun}(\Open(X), \catC^{\rm op})$,
y la categoría de $\mathsf{Sh}(X; \catC)$ es una subcategoría plena de $\mathsf{PSh}(X; \catC)$.
% Como los (pre)haces son un tipo de funtor contravariante se comprueba que $\mathsf{PSh}(X; \catC)$ es
% una subcategoría plena de ;
% luego en particular tenemos lo siguiente:
\begin{prop}
	Sea $X$ un espacio topológico y $\mathscr{F}, \mathscr{G} \in \mathsf{PSh}(X; \catC)$ con $\alpha \in \Hom_{\mathsf{PSh}}(\mathscr{F}, \mathscr{G})$.
	Luego, las fibras en el punto $P \in X$ corresponden a un funtor covariante $(-)_P \colon \mathsf{PSh}(X; \catC) \to \catC$:
	\begin{center}
		\begin{tikzcd}[row sep=large]
			\mathscr{F} \dar["\varphi"', ""{name=s}] & \mathscr{F}_P \dar["\varphi_P", ""'{name=f}] \\
			\mathscr{G}                              & \mathscr{G}_P
			\ar[from=s, to=f, Rightarrow, "(-)_P"]
		\end{tikzcd}
	\end{center}
	Lo mismo vale para haces.
\end{prop}

\begin{prop}
	Sea $X$ un espacio topológico y $\mathscr{F}$ un prehaz sobre $X$ con valores en una categoría bicompleta $\catC$.
	Para cada abierto $U \subseteq X$ y cada punto $x \in X$ se determinan dos únicas flechas
	\begin{center}
		\begin{tikzcd}
			\displaystyle
			\mathscr{F}(U )
			\rar["\alpha"] &
			\prod_{y \in U} \mathscr{F}_y
				       &
			\coprod_{x\in V} \mathscr{F}(V)
			\rar["\beta"] &
			\mathscr{F}_x,
		\end{tikzcd}
	\end{center}
	tales que $\alpha\circ\pi_x = \rho^U_x$ para cada punto $x \in U$ y tales que $\iota_V \circ \beta = \rho^V_y$ para cada $V$ entorno de $y$.
	Más aún, si $\mathscr{F}$ es un haz, entonces $\alpha$ es un monomorfismo y $\beta$ es un epimorfismo.
\end{prop}
\begin{proof}
	La existencia (y unicidad) de las flechas se desprende de la definición de (co)producto.
	El que $\alpha$ sea un monomorfismo lo verificaremos en el caso concreto: Aquí $\alpha(s) := (s|_x)_{x\in U}$,
	luego dos secciones $s, t \in \Gamma(U, \mathscr{F})$ satisfacen que $\alpha(s) = \alpha(t)$ syss $s|_y = t|_y$ para cada $y \in U$.
	Esto significa que existe un entorno $V_y \subseteq U$ y una sección $u_y \in \Gamma(V_y, \mathscr{F})$ tal que $s|_{V_y} = u_y = t|_{V_y}$.
	Así, vemos que $s, t$ coinciden en abiertos $V_x$ que cubren todo $U$, luego por el axioma de pegado son iguales.

	El que $\beta$ sea un epimorfismo también se puede verificar en el caso concreto, en donde corresponde a decir que todo gérmen local en $y$ viene
	de alguna sección sobre un entorno de $y$.
\end{proof}
\begin{prop}
	Dado un espacio topológico $X$ y un morfismo $\varphi \colon \mathscr{F} \to \mathscr{G}$ de haces de conjuntos sobre $X$. Entonces:
	\begin{enumerate}
		\item $\varphi$ es un monomorfismo syss $\varphi_x$ lo es para todo $x \in X$.
		\item $\varphi$ es un isomorfismo syss $\varphi_x$ lo es para todo $x \in X$.
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item $\impliedby$. Basta construir el siguiente diagrama conmutativo:
			\begin{center}
				\begin{tikzcd}[sep=large]
					\displaystyle
					\mathscr{F}(U) \rar["\varphi_U"] \dar[hook] & \mathscr{G}(U) \dar[hook] \\
					\prod_{x\in U} \mathscr{F}_x \rar["\prod_{x\in U} \varphi_x"] & \prod_{x\in U} \mathscr{G}_x
				\end{tikzcd}
			\end{center}
			Y notar que como la composición $\varphi_U \circ \alpha$ es un monomorfismo, entonces $\varphi_U$ también.

			$\implies.$ Sean $s, t \in \mathscr{F}(U)$ un par de secciones tales que
			\[
				\varphi(s)|_x = \varphi_x(s|_x) = \varphi_x(t|_x) = \varphi(t)|_x,
			\]
			para algún $x \in U$.
			Entonces existe un subentorno $x \in V \subseteq U$ tal que $\varphi_V(s|_V) = \varphi_U(s)|_V = \varphi_U(t)|_V = \varphi_V(t|_V)$.
			Luego, puesto que $\varphi_V$ es un monomorfismo, se cumple que $s|_V = t|_V$ y así vemos que $s|_x = t|_x$,
			lo que completa la inyectividad de $\alpha$.

		\item $\implies.$ Basta recordar que localizar $(-)_x$ es funtorial.

			$\impliedby.$ Por el inciso anterior ya sabemos que $\varphi$ es un monomorfismo, basta ver que es un epimorfismo.

			Sea $t \in \Gamma(U, \mathscr{G})$ una sección.
			Luego para todo $y \in U$ se tiene que $t|_y = \varphi_y(s_y)$ para algún germén local.
			Así que existe un subenterno $y \in V_y \subseteq U$ tal que $u|_{V_y} = t|_{V_y}$, donde $u \in \Gamma(V_y, \mathscr{G})$
			es tal que $u|_y = \varphi_y(s^y)$.
			Ahora bien, $s^y$ viene de alguna sección ${\tilde{s̃}}^y \in \Gamma({\tilde{Ṽ}}_y, \mathscr{F})$
			y luego $\varphi_{\tilde{Ṽ}_y} (\tilde{s̃}^y)|_y = u|_y$, por lo que coinciden en un subentorno $y \in W_y \subseteq U$
			y finalmente definimos $v^y := \tilde{s}^y|_{W_y}$.
			Así, tenemos una colección de $v^y$'s tales que $\varphi_{W_y}(v^y) = t|_{W_y}$ y como $\varphi$ es inyectivo,
			entonces se verifica que los $v^y$'s son compatibles y se pegan en $v$.
			\qedhere
	\end{enumerate}
\end{proof}

\begin{exn}
	Sea $X$ un espacio topológico, $\catC$ una categoría completa y sea $(A_x)_{x\in X}$ una familia de objetos en $\catC$. Definiendo
	$$ \Gamma(U, \Pi) := \prod_{y\in U} A_y. $$
	con las restricciones naturales (dadas, en el caso concreto, por eliminar coordenadas),
	entonces se comprueba que $\Pi$ es un prehaz.

	Supongamos que $\catC$ es concreta.
	Entonces una sección $(s_y)_y \in \Gamma(U, \Pi)$ es una función de elección $s_y \in A_y$.
	Luego dos secciones $(s_u)_{u\in U}|_{U \cap V} = (t_v)_{v\in V}|_{U \cap V}$ coinciden syss $s_x = t_x$ para cada $x \in U \cap V$,
	por lo que podemos pegarlas de manera única en una sección $(s_y )_{y\in U\cup V}$.
	Así, $\Pi$ es de hecho un haz.

	Ahora bien, es fácil notar que las fibras
	$$ \Pi_x = \prod_{x \speto y} A_y, $$
	donde $y$ recorre los puntos que están en todos los entornos de $x$.
	Así existe un monomorfismo $A_x \to \Pi_x$ y también un epimorfismo $\Pi_x \to A_x$ cuya composición es $1_{A_x} \colon A_x \to A_x$,
	pero no necesariamente son iguales.
	Nótese que la igualdad se alcanza syss $x$ es un punto cerrado.
\end{exn}
Al lector, argumente que el prehaz anterior es un haz cuando $\catC$ no es necesariamente concreta.

\begin{prop}
	Dado un prehaz $\mathscr{F} \in \mathsf{PSh}(X; \catC)$, entonces podemos considerar
	el funtor $\Hom_{\mathsf{PSh}}(\mathscr{F}, -) \colon \mathsf{Sh}(X; \catC) \to \mathsf{Set}$:
	\begin{multicols}{2}
		\begin{align*}
			h^\varphi \colon \Hom_{\mathsf{PSh}}(\mathscr{F, G}) &\longrightarrow \Hom_{\mathsf{PSh}}(\mathscr{F, H}) \\
			\psi &\longmapsto \varphi\circ \psi
		\end{align*}
		\begin{center}
			\begin{tikzcd}
				\mathscr{G} \dar["\varphi"', ""{name=s}] & \Hom_{\mathsf{PSh}}(\mathscr{F, G}) \dar["h^\varphi", ""'{name=f}] \\
				\mathscr{H}			      & \Hom_{\mathsf{PSh}}(\mathscr{F, H})
			\end{tikzcd}
		\end{center}
	\end{multicols}
	Éste funtor es representable por un único objeto y flecha $\iota \colon \mathscr{F \to F}^+$,
	el cual es un haz y se dice la \strong{hazificación}\index{hazificación} de $\mathscr{F}$.

	Más aún, para cada punto $x \in X$ se satisface que $\mathscr{F}_x = \mathscr{F}_x^+$, es decir, las fibras de un prehaz y su hazificación coinciden.
\end{prop}
\begin{proof}
	Definamos $\mathscr{F}^+$ como procede: para cada abierto $U \subseteq X$ una sección $(s_y)_y \in \Gamma(U, \mathscr{F}^+)$,
	corresponde a una tupla $(s_y)_y \in \prod_{y\in U} \mathscr{F}_y$ tal que cada punto $x \in U$ posee un subentorno $x \in V \subseteq U$ y una sección
	$\sigma \in \mathscr{F}(V)$ tal que $s_v = \gamma|_v$ para todo $v \in V$.
	
	Claramente si $U \subseteq V$ son abiertos, entonces hay una proyección natural
	\begin{center}
		\begin{tikzcd}[sep=large]
			\prod_{u\in U} \mathscr{F}_u \rar & \prod_{v\in V} \mathscr{F}_v,
		\end{tikzcd}
	\end{center}
	que luego determina una restricción entre secciones. Así $\mathscr{F}^+$ es un prehaz.

	Además, si $U \subseteq X$ es abierto, entonces la flecha $\mathscr{F}(U) \to \prod_{u\in U} \mathscr{F}_u$ producto de localizaciones
	tiene valores en $\mathscr{F}^+ (U)$, de modo que determina un morfismo de prehaces $\mathscr{F \to F}^+$, y claramente $\mathscr{F}^+$ es
	un subprehaz de $\Pi$ del ejemplo anterior, luego hereda unicidad de pegado.
	Finalmente es fácil notar que en $\mathscr{F}^+$ también se pueden pegar secciones, por lo que, es un haz.

	Por el mismo ejemplo, hay una inyección $\mathscr{F}_x \to \mathscr{F}_x^+$,
	por lo que basta probar que es suprayectiva.
	Sea $s̄ \in \mathscr{F}_x^+$, luego existe un entorno $x \in U$ tal que $s̄ = (s_u)_{u\in U}|_x$.
	Por definición existe un subentorno $x \in V \subseteq U$ y una sección $\sigma \in \mathscr{F}(V)$ tal que $s_v = \sigma|_v$ para todo $v \in V$.
	Trivialmente, la imagen de $\sigma$ es $s̄$. Así $\mathscr{F}_x \to \mathscr{F}_x^+$ es un isomorfismo.
	Finalmente, es fácil notar que la hazificación determina un funtor $(-)^+ \colon \mathsf{PSh} \to \mathsf{Sh}$.
	Así que si $\psi \colon \mathscr{F} \to \mathscr{G}$ es un morfismo de prehaces, determina un morfismo $\psi^+ \colon \mathscr{F}^+ \to \mathscr{G}^+$
	de haces.
	Además tenemos el morfismo de prehaces $\iota_{\mathscr{G}} \colon \mathscr{G} \to \mathscr{G}^+$ que es un isomorfismo en las fibras,
	luego es un isomorfismo de haces por la proposición 3.42, de modo que $\psi$ se factoriza por $\mathscr{F} \to \mathscr{F}^+ \to \mathscr{G}$.
\end{proof}
\begin{ex}
	La hazificación del prehaz constante $A^-_X$ es el haz constante $A^+_X$, de ahí la simbología.
\end{ex}

\begin{cor}
	La hazificación determina un funtor $(-)^+ \colon \mathsf{PSh}(X; \catC) \to \mathsf{Sh}(X; \catC)$ que es la adjunta izquierda
	del funtor semiolvidadizo $U \colon \mathsf{Sh}(X; \catC) \to \mathsf{PSh}(X; \catC)$. En símbolos:
	$$ (-)+ \adjoint U, \qquad \Hom_{\mathsf{Sh}}(\mathscr{F}^+ , \mathscr{G}) \approx \Hom_{\mathsf{PSh}}(\mathscr{F}, U\mathscr{G}). $$
\end{cor}
Hay dos consecuencias que entender del corolario anterior.
La primera es que como $U$ tiene adjunta izquierda, entonces preserva límites inversos, y los límites en la categoría de prehaces se calculan
puntualmente pues es esencialmente una categoría de funtores.
La segunda es que, en general, \textit{no} preserva límites directos, así que no es tan fácil calcularlos entre haces y, la solución tecnica
es calcular puntualmente un límite directo y hazificar.
% Uno de los usos para la hazificación es el siguiente:

% §3.2.1 Límites de (pre)haces. No olvidemos que fundamentalmente la
% categoría de prehaces es una categoría de funtores contravariantes, así que
% veamos resultados relativos a ello:
% Proposición 3.45: Sea X un espacio topológico. Un diagrama F− \colon D \to 
% PSh(X; C ) de prehaces posee un límite inverso (resp. directo)
\subsection{Funtores con haces}
\begin{prop}
	Sea $\catC$ una categoría cocompleta y sea $f \colon X \to Y$ una función continua entre espacios topológicos.
	\begin{enumerate}
		\item Dado un prehaz $\mathscr{F} \in \mathsf{PSh}(X; \catC)$. Entonces definiendo para todo $V \subseteq Y$ abierto:
			$$ \Gamma(V, f_*\mathscr{F}) := \Gamma(f^{-1} [V ], \mathscr{F} ), $$
			se cumple que $f_*\mathscr{F} \in \mathsf{PSh}(Y; \catC)$, llamado el prehaz preimagen.
			Esto determina un funtor $f_*(-) \colon \mathsf{PSh}(X; \catC) \to \mathsf{PSh}(Y ; \catC)$.

		\item  Dado un prehaz $\mathscr{G} \in \mathsf{PSh}(Y; \catC)$.
			Entonces definiendo para todo $U \subseteq X$ abierto:
			$$ \Gamma(U, f_p \mathscr{G} ) := \limdir_{V \supseteq f[U]} \Gamma(V, \mathscr{G} ), $$
			se cumple que $f_p \mathscr{G} \in \mathsf{PSh}(X; \catC)$, llamado el prehaz imagen directa.
			Esto determina un funtor $f_p(-) \colon \mathsf{PSh}(Y; \catC) \to \mathsf{PSh}(X; \catC)$.
	\end{enumerate}
	Más aún, existe un isomorfismo canónico en las fibras: para todo $y \in Y$ se cumple $(f_p \mathscr{G})_y = \mathscr{G}_{f(y)}$.
\end{prop}
\begin{proof}
	Las afirmaciones son todas triviales, exceptuando la de las fibras. Sea $x \in X$, entonces
	\begin{equation}
		(f_p \mathscr{G})_x = \limdir_{x\in U} f_p \mathscr{G}(U) = \limdir_{x\in U} \limdir_{V \supseteq f[U]} \mathscr{G}(V ) = \mathscr{G}_{f(x)}.
		\tqedhere
	\end{equation}
\end{proof}

\begin{prop}
	Sea $\catC$ una categoría cocompleta y sea $f \colon X \to Y$ una función continua entre espacios topológicos.
	Dados $\mathscr{F, G}$ prehaces sobre $X, Y$ resp. con valores en $\catC$, entonces el funtor $f_p(-)$ es la adjunta izquierda de $f_*(-)$.
	En símbolos:
	$$ f_p(-) \adjoint f_*(-), \qquad \Hom_{\mathsf{PSh}(X)} (f_p \mathscr{G}, \mathscr{F}) \approx \Hom{\mathsf{PSh}(Y)} (\mathscr{G}, f_* \mathscr{F}). $$
\end{prop}
\begin{proof}
	Para todo $U \subseteq Y$ abierto se cumple que $f\big[ f^{-1} [U ] \big] \subseteq U$, de modo que existe una flecha canónica
	$\mathscr{G}(U) \to f_p \mathscr{G}(f^{-1} [U ])$.
	Esto determina un morfismo de prehaces $\varepsilon_{\mathscr{G}} \colon \mathscr{G} \to f_* f_p \mathscr{G}$.

	Por otro lado, para todo $U \subseteq X$ abierto se cumple que $f^{-1}\big[ f [U ] \big] \supseteq U$, entonces para todo $V \supseteq f [U ]$
	abierto de $Y$ se cumple que $f^{-1} [V ] \supseteq U$ de modo que tenemos la flecha de la restricción $\mathscr{F}(f^{-1}[V ]) \to F (U )$,
	y luego existe una única flecha canónica $f_p f_* \mathscr{F} (U ) \to \mathscr{F} (U )$ que determina un morfismo
	de prehaces $\eta_{\mathscr{F}} \colon f_p f_* \mathscr{F} \to \mathscr{F}$.

	Finalmente, dado un par de morfismos de prehaces $\alpha \colon \mathscr{G} \to f_* \mathscr{F}$ y $\beta \colon f_*\mathscr{G} \to \mathscr{F}$,
	entonces se inducen los siguientes morfismos:
	\begin{center}
		\includegraphics{geo-alg/adjointness.pdf}
	\end{center}
	Queda al lector verificar que éstas construcciones son una la inversa de la otra.
\end{proof}

\begin{prop}
	Sean $f \colon X \to Y$ una función continua entre espacios topológicos, $\catC$ una categoría cocompleta y $\mathscr{F} \in \mathsf{Sh}(X; \catC)$ un haz.
	Entonces $f_* \mathscr{F} \in \mathsf{Sh}(Y; \catC)$ también es un haz.
\end{prop}
La misma condición no necesariamente se da con $f_p$.
\begin{mydef}
	Sea $f \colon X \to Y$ una función continua entre espacios topológicos y $\catC$ una categoría cocompleta.
	Dado un haz $\mathscr{G} \in \mathsf{Sh}(Y; \catC)$, se define el \strong{haz imagen directa} como la hacificación
	$$ f^{-1} \mathscr{G} := (f_p\mathscr{G})^+ \in \mathsf{Sh}(X; \catC). $$
\end{mydef}
\begin{cor}
	Sea $f \colon X \to Y$ una función continua entre espacios topológicos y $\catC$ una categoría cocompleta.
	El funtor $f^{-1}(-) \colon \mathsf{Sh}(Y ; \catC) \to \mathsf{Sh}(X; \catC)$ es la adjunta izquierda del
	funtor $f_*(-) \colon \mathsf{Sh}(X; \catC) \to \mathsf{Sh}(Y; \catC)$.
	En símbolos:
	$$ f^{-1}(-) \adjoint f_*(-), \qquad \Hom_{\mathsf{Sh}(X)} (f^{-1} \mathscr{G}, \mathscr{F}) \approx \Hom{\mathsf{Sh}(Y)} (\mathscr{G}, f_* \mathscr{F}). $$
	Más aún, para cada $x \in X$ se cumple que $(f^{-1} \mathscr{G})_x = \mathscr{G}_{f(x)}$.
\end{cor}

\section{Esquemas}
\subsection{Espacios anillados y esquemas afínes}
\begin{mydefi}
	Un par $(X, \mathscr{O}_X)$ se dice un espacio anillado si $X$ es un espacio topológico y $\mathscr{O}_X$ es un haz de anillos sobre $X$,
	al que llamamos \strong{haz estructural}\index{haz!estructural} de $X$.
	Obviaremos el haz estructural de no haber ambigüedad en los signos.
	A las secciones de $\Gamma(U, \mathscr{O}_X )$ les llamamos \strong{funciones regulares}\index{función!regular} sobre $U$.

	Un \strong{morfismo de espacios anillados} es un par $(f, f^\sharp ) \colon (X, \mathscr{O}_X ) \to (Y, \mathscr{O}_Y )$
	donde $f \colon X \to Y$ es una función continua y $f^\sharp \colon \mathscr{O}_Y \to f^* \mathscr{O}_X$ es un morfismo de haces sobre $Y$.
\end{mydefi}
Por el corolario anterior, elegir $f^\sharp \colon f^{-1} \mathscr{O}_Y \to \mathscr{O}_X$ determinaría la misma información.

\begin{prop}
	Los espacios anillados (como objetos) y los morfismos entre ellos (como flechas) conforman una categoría.
\end{prop}
\begin{ex}
	Los conjuntos algebraicos (sobre $k$) presentadas en la primera parte, junto con las funciones regulares, forman espacios anillados.
\end{ex}
Fijemos un anillo $A$, podemos construir un haz sobre $\Spec A$ de la siguiente manera:
\begin{mydef}
	Dado un anillo $A$, definamos $\mathscr{O}_{\Spec A} \in \mathsf{PSh}(\Spec A; \mathsf{Set})$ donde,
	para todo abierto $U \subseteq \Spec A$ definimos $\mathscr{O}_{\Spec A}(U )$ como el conjunto de aplicaciones $s \colon U \to
	\prod_{x\in U} A_{\mathfrak{p}_x}$ tales que:
	\begin{enumerate}[{HE}1.]
		\item Para cada $x \in U$ se cumple que $s(x) \in A_{\mathfrak{p}_x}$.
		\item Las aplicaciones $s$ son localmente fracciones sobre $A$.
			Vale decir, para cada $x \in U$ existe un entorno $x \in V \subseteq U$ y unos elementos $a, f \in A$ tales que
			$$ y \in V \setminus \VV(f ) = V \cap \DD(f ) \implies s(y) = a/f. $$
	\end{enumerate}
	Si $U \subseteq V$, entonces $\rho^V_U \colon \mathscr{O}_{\Spec A}(U ) \to \mathscr{O}_{\Spec A}(V)$ es la restricción natural.
	Definiendo la suma y producto coordenada a coordenada, se prueba que $\mathscr{O}_{\Spec A}$ determina un prehaz de anillos.
\end{mydef}
\begin{prop}
	$(\Spec A, \mathscr{O}_{\Spec A})$ es un espacio anillado.
\end{prop}
Nótese que lo que hay que demostrar es que esencialmente $\mathscr{O}_{\Spec A}$ es un haz.
Ahora, tenemos derecho de llamar a $\mathscr{O}_{\Spec A}$  como el haz estructural (canónico) sobre $\Spec A$.

\begin{thm}
	Sea $A$ un anillo y sea $X := \Spec A$. Entonces:
	\begin{enumerate}
		\item Para todo $x \in \Spec A$ se cumple que $\mathscr{O}_{X, x} \cong A_{\mathfrak{p}_x}$ .
		\item Para todo $f \in A$ se cumple que $\Gamma(\DD(f ), \mathscr{O}_X) \cong A[1/f ]$.
		\item En particular, $\Gamma(X, \mathscr{O}_X) \cong A$.
	\end{enumerate}
\end{thm}
\begin{proof}
	\begin{enumerate}
		\item Definamos la siguiente aplicación:
			\begin{align*}
				\varphi := \ev_x \colon \mathscr{O}_{X, x} &\longrightarrow A_{\mathfrak{p}_x} \\
				s &\longmapsto s(x)
			\end{align*}
			la cual claramente está bien definida; es un $A$-homomorfismo de álgebras y es suprayectiva pues, dado $a/f \in A_{\mathfrak{p}_x}$,
			donde $f \notin \mathfrak{p}_x$, basta elegir la aplicación constante $s = a/f \in \Gamma(\DD(f), \mathscr{O}_X)$ y localizar en el haz.

			Veamos que $\varphi$ es un monomorfismo: para ello, sean $s \in \mathscr{O}_X(U_1), t \in \mathscr{O}_X(U_2)$ tales que $s(x) = t(x)$,
			veamos que coinciden en un abierto.
			Por la propiedad HE2, se cumple que $s = a/f$ en $U_1 \cap \DD(f)$ y $t = b/g$ en $U2 \cap \DD(g)$ para algunos $f, g \notin \mathfrak{p}_x$.
			Luego $a/f = s(x) = t(x) = b/g$ y así, coinciden en $U_1 \cap U_2 \cap \DD(f ) \cap \DD(g)$ que es un entorno de $x$.

		\item Definamos $\psi \colon A[1/f ] \to \Gamma(D(f ), \mathscr{O}_X)$ que a cada elemento $a/f^n$ le asigna
			la función $s$ tal que $s(x) = a/f^n \in A_{\mathfrak{p}_x}$.
			Claramente $s$ es un homomorfismo de $A$-álgebras.

			\underline{$\psi$ es monomorfismo:} Si $\psi(a/f^n ) = \psi(b/f^m )$, entonces $a/f^n = b/f^m$ en todo $A_{\mathfrak{p}}$,
			donde $f \notin \mathfrak{p}$.
			Así, existe $h \notin \mathfrak{p}$ tal que $h(f^m a - f^n b) = 0 \in A$.
			Sea $\mathfrak{a} := \Ann(f^m a - f^n b)$, luego $h \in \mathfrak{a \setminus p}_x$ y así $\mathfrak{a} ̸\subseteq Z_x$ para todo
			$x \in \DD(f)$; ergo, $\VV(a) \cap \DD(f) = \emptyset$.
			En conclusión $\VV(f ) \subseteq \VV(\mathfrak{a})$ y, por el teorema de ceros de Hilbert, $f \in \rad\mathfrak{a}$, es decir,
			$f^\ell \in \mathfrak{a}$ y $f^\ell (f^m a - f^n b) = 0$, por lo que, $a/f^n = b/f^m$ en $A[1/f ]$.

			\underline{$\psi$ es epimorfismo:} Sea $s \in \Gamma(\DD(f ), \mathscr{O}_X)$, por HE2, $\DD(f ) \subseteq \bigcup_{i\in I} V_i$
			donde en cada $V_i$ se cumple que $s$ es constante y vale, digamos, $a_i/g_i$ con $V_i \subseteq \DD(g_i)$.
			Como los abiertos principales forman una base, podemos suponer que $V_i = \DD(h_i )$ para algún $h_i$ y luego,
			por el teorema de ceros de Hilbert, $h_i^{m_i} \in g_iA$ para algún $m_i$.
			Luego $h_i^{m_i} = c_i g_i$ para algún $ci \in A$ y, en consecuente, $a_i /g_i = ca_i /h_i^{m_i}$; así, sustituyendo $a_i$ por $c_i a_i$
			y $h_i$ por $h_i^{m_i}$, podemos suponer que $\DD(f )$ está cubierto por abiertos $\DD(h_i)$ en donde $s$ vale $a_i/h_i$.

			Podemos extraer un subcubrimiento finito de $\DD(f )$ pues
			$$ \DD(f ) \subseteq \bigcup_{i\in I} \DD(h_i) = \DD\left( \sum_{i\in I} h_iA \right) $$
			lo que, por el teorema de ceros de Hilbert, equivale a que $f^n \in \sum_{i\in I} h_iA$, pero $f^n$ claramente está en una suma
			de algunos finitos $h_i$'s, luego reescribiendo tenemos que $\DD(f ) \subseteq \bigcup_{i=1}^n \DD(h_i)$.

			Ahora bien, dados $h_i, h_j$ con $i ̸= j$, se tiene que $\DD(h_i) \cap \DD(h_j) = \DD(h_i h_j) ̸= \emptyset$ y $s$ es constante
			y vale $a_i /h_i = a_j /h_j \in A[1/h_i h_j ]$ en $\DD(h_i h_j)$, luego
			$$ (h_i h_j )^n (a_i h_j - a_j h_i ) = 0, $$
			donde como hay finitos índices $i$'s podemos elegir un $n$ suficientemente grande.
			La fórmula se reescribe como $h_j^{n+1} (h^n_i a_i ) - h^{n+1}_i(h_j^n a_j) = 0$, así que, reemplazando $a_i$ por $a_i h^n_i$
			y $h_j$ por $h{n+1}_j$, obtenemos que $h_j a_i = h_i a_j$ para todo $i, j$.
			Ahora, como $\DD(f) \subseteq \DD\left( \sum_{i=1}^{n} h_i \right)$, tenemos que $f^m = \sum_{i=1}^{n} b_ih_i$ para algunos $b_i \in A$.
			Definiendo $a := \sum_{i=1}^{n} b_ia_i$ se tiene que
			$$ h_j a = \sum_{i=1}^{n} b_i a_i h_j = \sum_{i=1}^{n} b_i h_i a_j = f^m a_j. $$
			Luego $s$ toma, en cada $\DD(h_i)$, el valor $a/f^m \in A[1/f ]$ como se quería probar.

		\item Considere el inciso anterior con $f = 1$. \qedhere
	\end{enumerate}
\end{proof}

\begin{mydef}
	Sean $(A, \mathfrak{m}), (B, \mathfrak{n})$ dos anillos locales.
	Una aplicación $\varphi \colon A \to B$ se dice un \strong{homomorfismo de anillos locales}\index{homomorfismo!de anillos locales}
	si es un homomorfismo de anillos tal que $\varphi^{-1}[\mathfrak{n}] = \mathfrak{m}$.
\end{mydef}
\begin{prop}
	Si $\varphi \colon (A, \mathfrak{m}) \to (B, \mathfrak{n})$ es un homomorfismo de anillos locales,
	entonces determina un único monomorfismo $\bar\varphi\colon A/\mathfrak{m} \hookto B/\mathfrak{n}$ de cuerpos.
\end{prop}
\begin{proof}
	Basta aplicar el primer teorema de isomorfismos, notar que $\bar \varphi$ no es nula, y recordar que todo homomorfismo cuyo dominio es un
	cuerpo es necesariamente un monomorfismo.
\end{proof}
Veamos ahora el caso local:
\begin{mydef}
	Un \strong{espacio localmente anillado}\index{espacio!localmente anillado} $(X, \mathscr{O}_X )$ es un espacio anillado en donde
	cada fibra $\mathscr{O}_X,x$ es un anillo local con ideal maximal $\mathfrak{m}_{X,x}$ y con \strong{cuerpo de restos}
	\nomenclature{$\kk(x)$}{$= \mathscr{O}_{X, x} / \mathfrak{m}_{X, x}$, cuerpo de restos de un esquema $X$ en un punto $x$}
	$\kk(x) := \mathscr{O}_{X, x} / \mathfrak{m}_{X, x}$.

	Sean $(X, \mathscr{O}_X ), (Y, \mathscr{O}_Y )$ un par de espacios localmente anillados.
	Un par $(f, f^\sharp ) \colon (X, \mathscr{O}_X ) \to (Y, \mathscr{O}_Y )$ se dice un \strong{morfismo de espacios localmente anillados}%
	\index{morfismo!de espacios localmente anillados} si es un morfismo de espacios anillados, y en cada fibra $f_y^\sharp \colon \mathscr{O}_{Y,y} \to 
	(f_*\mathscr{O}_X)_y$ es un homomorfismo de anillos locales.
\end{mydef}
Como la información $f^\sharp \colon \mathscr{O}_Y \to f_* \mathscr{O}_X$ coincide con una flecha $f^\sharp \colon f^{-1} \mathscr{O}_Y \to \mathscr{O}_X$,
entonces podemos ver que es lo mismo exigir que para $x \in X$ se induce un homomorfismo de anillos locales
$$ f_x^\sharp \colon (f^{-1} \mathscr{O}_Y )_x = \mathscr{O}_{Y,f (x)} \longrightarrow \mathscr{O}_{X,x}. $$
Esto corresponderá mejor con la situación dada entre espectros de anillos.

Sumado a la proposición anterior, nos da que:
\begin{prop}\label{thm:mono_fibers}
	Sea $f \colon X \to Y$ un morfismo de espacios localmente anillados.
	Entonces, para cada punto $x \in X$ se determina un monomorfismo entre los cuerpos de restos $\bar f_x \colon \kk\big( f(x) \big) \hookto \kk(x)$.
\end{prop}
\begin{cor}
	Los espacios de la forma $\Spec A$ con el haz estructural son espacios localmente anillados.
\end{cor}

\begin{mydef}
	Los espacios localmente anillados de la forma $\Spec A$ con el haz estructural se dicen esquemas afínes.
\end{mydef}
\begin{mydef}
	Sea $A$ un anillo.
	El \strong{espacio afín}\index{espacio!afín} de dimensión $n$ sobre $A$, denotado $\A^n_A$, es el esquema afín $\A^n_A := \Spec(A[t_1, \dots, t_n])$.
\end{mydef}
\begin{ex}
	Si $k$ es un cuerpo, entonces dado un punto $P := (\alpha_1, \dots, \alpha_n) \in k^n$ se satisface que
	el ideal $x_P := (t_1 - \alpha_1, \dots, t_n - \alpha_n)$ es maximal, luego es un punto cerrado de $\A^n_k$.
	Más aún, si $k$ es algebraicamente cerrado, entonces por el teorema débil de ceros de Hilbert, todos los puntos cerrados de $\A^n_k$ son de la forma $x_P$.
\end{ex}

\begin{prop}
	Sean $A, B$ anillos. Todo homomorfismo de anillos $\varphi \colon A \to B$ induce un morfismo de espacios localmente anillados
	$$ (\varphi^a, \varphi^\sharp) \colon \Spec B \longrightarrow \Spec A. $$
	Más aún cada morfismo de espacios localmente anillados viene de un homomorfismo de anillos.
\end{prop}
\begin{proof}
	Por brevedad, denotaremos $f := \varphi^a$ el que se define como $f(x) := \varphi^{-1}[\mathfrak{p}_x]$.
	Para cada punto $y \in \Spec B$ se determina un homomorfismo de anillos locales $\varphi_y \colon A_{f(y)} \to B_y$.
	Así, para cada abierto $U \subseteq \Spec A$ y cada sección $s \in \Gamma(U, \mathscr{O}_{\Spec A} )$, definimos:
	\begin{align*}
		\varphi^\sharp \colon f^{-1}[U] &\longrightarrow \coprod_{y \in f^{-1}[U]} B_{\mathfrak{p}_y} \\
		y &\longmapsto \varphi_y\big( s(f(y)) \big).
	\end{align*}
	Queda al lector verificar que efectivamente $\varphi^\sharp (s)$ determina una sección de $\Gamma(f^{-1} [U ], \mathscr{O}_{\Spec B})$.

	Sea $(f, f^\sharp) \colon \Spec B \to \Spec A$ un morfismo de espacios localmente anillados, entonces consideramos las secciones
	globales $f^\sharp \colon \Gamma(\Spec A, \mathscr{O}_{\Spec A}) \to \Gamma(\Spec B, \mathscr{O}_{\Spec B})$ y recordamos que,
	por la proposición anterior,
	\[
		\Gamma(\Spec R, \mathscr{O}_{\Spec R} ) \cong R
	\]
	para todo anillo $R$, luego determina un homomorfismo de anillos $\varphi \colon A \to B$.
	Para cada $\mathfrak{p} \in \Spec B$, mirando las fibras tenemos el siguiente diagrama conmutativo:
	\begin{center}
		\begin{tikzcd}[row sep=large]
			A \dar[hook] \rar["\varphi"] & B \dar[hook] \\
			A_{f(\mathfrak{p})} \rar["f^\sharp_{\mathfrak{p}}"] & B_{\mathfrak{p}}
		\end{tikzcd}
	\end{center}
	con lo que, empleando que $f_{\mathfrak{p}}^\sharp$ es un homomorfismo de anillos locales,
	concluimos que $f(\mathfrak{p}) = \varphi^{-1}[\mathfrak{p}]$ y $f_{\mathfrak{p}}^\sharp = \varphi_{\mathfrak{p}}$.
\end{proof}
\begin{ex}
	Sea $A := \C$ y considere $\sigma \colon \C \to \C$ el isomorfismo de cuerpos dado por la conjugación compleja.
	Entonces induce un isomorfismo de esquemas $\sigma^a \colon \Spec\C \to \Spec\C$.
	Ahora bien, el único punto de $\Spec\C$ es $\xi := (0)$, luego necesariamente $\sigma^a$ (como función continua) es la función que fija a $\xi$.
	Así, $\sigma^a = \Id^a$ (como función continua), pero $\sigma^\sharp ̸\ne \Id^\sharp$.
\end{ex}
Éste ejemplo sencillo ilustra que las funciones entre esquemas no están únicamente determinadas por la función entre espacios subyacentes.

\begin{exn}
	Sea $A$ un dominio de valuación discreta, por ende, un dominio íntegro con sólo dos ideales primos $X := \Spec A = \{ (0), \mathfrak{m} \}$.
	Nótese que $A_{\mathfrak{m}} = A$ y que $A_{(0)} = \Frac A =: K$.
	La inclusión $\lambda \colon A \to K$ da lugar al morfismo de espacios localmente anillados $(f, f^\sharp ) \colon \Spec K \to X$, donde,
	como $\Spec K = \{ (0) \}$, vemos que $f(y_0) = x_0$.

	No obstante, podemos definir otro morfismo de espacios anillados\break $(g, g^\sharp ) \colon \Spec K \to X$ tal que $g(y_0) = x_m$.
	Nótese que $X$ posee tres abiertos: $X, \{ x_0 \}, \emptyset$. Así podemos verificar que $g_*\mathscr{O}_{\Spec K}$ es el haz sobre $X$:
	$$ \Gamma(U, g_*\mathscr{O}_{\Spec K}) =
	\begin{cases}
		K, & U = X \\
		0, & U \ne X
	\end{cases} $$
	y construir $g^\sharp (\{ x_0 \}) := \Id_K \colon K \to K$ y $g^\sharp (X) \colon A \to 0$ el morfismo nulo.

	Finalmente, nótese que $g^\sharp_{x_{\mathfrak{m}}} \colon A \to 0$ no es un homomorfismo de anillos locales, por lo que,
	$(g, g^\sharp )$ no es un morfismo de espacios localmente anillados.
\end{exn}

Para finalizar ésta subsección, introduciremos una noción que jugará un rol fundamental más adelante:
\begin{mydef}
	Un \strong{encaje abierto}\index{encaje abierto} (resp. \strong{cerrado}\index{encaje!cerrado}) de espacios anillados
	es un morfismo $(f, f^\sharp ) \colon (X, \mathscr{O}_X) \to (Y, \mathscr{O}_Y)$ tal que
	$f \colon X \to Y$ es un encaje topológico abierto (resp. cerrado)%
	\footnote{Es decir, si $f \colon X \to f [X]$ es un homeomorfismo, y si $f [X] \subseteq Y$ es abierto (resp. cerrado).}
	y cada $f_x^\sharp$ es un isomorfismo (resp. un epimorfismo) para todo $x \in X$.
\end{mydef}
Se denota por <<\begin{tikzcd}[cramped, sep=small] {} \rar[open] & {} \end{tikzcd}>> a los encajes abiertos,
y por <<\begin{tikzcd}[cramped, sep=small] {} \rar[closed] & {} \end{tikzcd}>> a los encajes cerrados.

Los encajes abiertos tienen una interpretación sencilla:
\begin{prop}
	Sea $(X, \mathscr{O}_X)$ un espacio anillado.
	\begin{enumerate}
		\item Para todo abierto $U \subseteq X$, se cumple que la inclusión
			\begin{center}
				\begin{tikzcd}[sep=large]
					(i, i^\sharp ) \colon (U, \mathscr{O}_X|_U ) \rar[open] & (X, \mathscr{O}_X)
				\end{tikzcd}
			\end{center}
			es un encaje abierto de espacios anillados.

		\item Más aún, todo encaje abierto 
		\begin{tikzcd}[cramped, sep=small]
			f \colon (Y, \mathscr{O}_Y ) \rar[open] & (X, \mathscr{O}_X),
		\end{tikzcd}
		con $U := f [Y ]$, se factoriza por:
		\begin{center}
			\begin{tikzcd}[row sep=large, column sep=small]
				Y \ar[rr, open, "f", near end] \drar["\bar f"'] \drar[draw=none, "\sim", sloped] & {}                  & X \\
				{}                                                                               & U \urar[open, "i"']
			\end{tikzcd}
		\end{center}
	\end{enumerate}
\end{prop}

Los encajes cerrados son más complicados, pero podemos dar un ejemplo canónico:
\begin{prop}
	Sea $A$ un anillo, $\mathfrak{a} \nsle A$ un ideal y sea $\pi \colon A \to A/\mathfrak{a}$ la proyección canónica.
	Entonces induce un encaje cerrado $\pi^a \colon \Spec(A/\mathfrak{a}) \to \Spec A$,
	de modo que $\Spec(A/\mathfrak{a}) \approx \VV(\mathfrak{a})$ (en $\mathsf{Top}$).
\end{prop}
\begin{proof}
	Las propiedades de $\pi^a$ ya las probamos, y es fácil notar que sobre un abierto principal $\DD(f)$
	se cumple que $\pi^\sharp \colon A[1/f ] \to (A/\mathfrak{a})[1/f]$ es la proyección canónica.
\end{proof}
\begin{ex}
	Sea $k$ un cuerpo y considere $A := k[\varepsilon]$, donde $\varepsilon$ es una indeterminada.
	Considere los ideales $\mathfrak{a} := (\varepsilon)$ y $\mathfrak{b} := (\varepsilon^2) = \mathfrak{a}_2$,
	así tenemos los siguientes encajes cerrados:
	\begin{center}
		\begin{tikzcd}[row sep=large, column sep=tiny]
			\Spec k \ar[rr, closed, "\alpha", near end] \drar[closed, "\gamma"'] & & \Spec( k[\varepsilon] ) \\
			{} & \displaystyle \Spec\left( \frac{k[\varepsilon]}{(\varepsilon^2)} \right) \urar[closed, "\beta"']
		\end{tikzcd}
	\end{center}
	Lo interesante es que tanto $\alpha$ como $\beta$ tienen por imagen el mismo cerrado $\VV(\mathfrak{a})$,
	pese a que, los esquemas afínes $\Spec k = \Spec(A/\mathfrak{a})$ y $\Spec(A/\mathfrak{b})$ no son isomorfos (¿por qué?).
	Otra curiosidad es que $\gamma$ es un encaje cerrado y suprayectivo que no es un isomorfismo de espacios localmente anillados.
\end{ex}
Y demostraremos una linda correspondencia, con lo siguiente:

\begin{mydef}
	Sea $(X, \mathscr{O}_X )$ un espacio anillado. Un haz $\mathscr{I}$ sobre $X$
	se dice un \strong{haz de ideales}\index{haz!de ideales} si cada $\mathscr{I}(U)$ es un ideal de $\mathscr{O}_X(U)$ y si la restricción
	$\mathscr{I}(U) \to \mathscr{I}(V)$ es un homomorfismo de $\mathscr{O}_X(U)$-módulos.
	Dado un haz de ideales $\mathscr{I}$ definimos:
	$$ \VV(\mathscr{I}) := \{ x \in X : \mathscr{I}_x ̸= \mathscr{O}_{X,x} \} \subseteq X. $$
\end{mydef}
Esta noción sigue estando dentro de nuestros limites, puesto que los ideales son grupos abelianos.

\addtocounter{thmi}{1}
\begin{slem}
	Sea $(X, \mathscr{O}_X )$ un espacio anillado e $\mathscr{I}$ un haz de ideales de $\mathscr{O}_X$.
	Entonces $Z := \VV(\mathscr{I})$ es un cerrado de $X$ y denotando $j \colon Z \to X$ la
	inclusión se verifica que $(Z, j^{-1} (\mathscr{O}_X /I ))$ es un espacio anillado y existe un
	encaje cerrado $(j, j^\sharp ) \colon Z \to X$ tal que $j^\sharp$ es el epimorfismo:
	\begin{equation}
		\begin{tikzcd}[sep=large]
			\mathscr{O}_X \rar[two heads] & \mathscr{O}_X/\mathscr{I} = j_*^{-1}(\mathscr{O}_X/\mathscr{I}).
		\end{tikzcd}
		\label{eqn:closed_inmersion}
	\end{equation}
\end{slem}
\begin{proof}
	Si $x \notin \VV(\mathscr{I})$, entonces $\mathscr{I}_x = \mathscr{O}_{X,x}$ y existe un entorno
	$x \in U$ y una sección $f \in \Gamma(U, \mathscr{I})$, de modo que su germen $f|_x = 1$, luego
	existe un subentorno $x \in V \subseteq U$ de modo que $f|_V = 1$ y así $V \subseteq X \setminus \VV(\mathscr{I})$.
	Finalmente para cada $x \in \VV(\mathscr{I})$ se cumple que las fibras
	$$ \big( j^{-1} (\mathscr{O}_X /\mathscr{I} ) \big)_x = (\mathscr{O}_X /\mathscr{I} )_x = \mathscr{O}_{X,x}/\mathscr{I}_x $$
	son anillos locales. Finalmente es claro verificar lo demás.
\end{proof}
\addtocounter{thmi}{-1}

\begin{prop}\label{thm:closed_subsch}
	Sea 
	\begin{tikzcd}[cramped, sep=small]
		(f, f^\sharp ) \colon (Y, \mathscr{O}_Y ) \rar[closed] & (X, \mathscr{O}_X )
	\end{tikzcd}
	un encaje cerrado de espacios anillados.
	Sea $Z$ el subespacio anillado con espacio topológico $\VV(\mathscr{I})$ donde $\mathscr{I} := \ker(f^\sharp ) \subseteq \mathscr{O}_X$.
	Entonces $f$ se factoriza por un isomorfismo $g \colon Y \to Z$ y la inclusión 
	\begin{tikzcd}[cramped, sep=small]
		j \colon Z \rar[closed] & X.
	\end{tikzcd}
\end{prop}
\begin{proof}
	Como $f [Y ]$ es cerrado en $X$, se puede comprobar que
	$$ (f_*\mathscr{O}_Y)_x =
	\begin{cases}
		0, & x \notin f[Y] \\
		\mathscr{O}_{Y, y}, & x \in f[Y]
	\end{cases} $$
	Por hipótesis se tiene la sucesión exacta $0 \to \mathscr{I} \to \mathscr{O}_X \to f_* \mathscr{O}_Y \to 0$ de
	haces (sobre X) y, por tanto, se verifica que $\mathscr{I}_x = \mathscr{O}_{X,x}$ syss $x \notin f [Y ]$,
	por lo que, $Z := \VV(\mathscr{I}) = f [Y ]$.
	Sea $g \colon Y \to Z$ el homeomorfismo inducido por $f$, y sea $j \colon Z \hookto X$ la inclusión canónica, claramente $f = g \circ j$
	y por la funtorialidad de $(-)_*$ tenemos que $f_* \mathscr{O}_Y = j_* g_* \mathscr{O}_Y$.
	Finalmente, empleando que $j$ es un encaje es fácil ver que se cumple
	$$ \mathscr{O}_Z = j^{-1} j_* \mathscr{O}_Z \cong j^{-1} j_* g_* \mathscr{O}_Y = g_* \mathscr{O}_Y, $$
	(¿por qué?), de modo que $g$ es un isomorfismo de espacios anillados como se quería ver.
\end{proof}
Ésta proposición aparecerá más adelante al clasificar subesquemas cerrados.

\subsection{Esquemas}
\begin{mydefi}
	Un \strong{esquema}\index{esquema} es un espacio localmente anillado $(X, \mathscr{O}_X)$ tal que todo punto $x \in X$ posee un entorno $x \in U$ tal que
	$(U, \mathscr{O}_X|_U)$ es isomorfo (como espacio localmente anillado) a un esquema afín.
	Un \strong{morfismo de esquemas}\index{morfismo!de esquemas} $(f, f^\sharp ) \colon (X, \mathscr{O}_X) \to (Y, \mathscr{O}_Y)$
	es un morfismo de espacios localmente anillados.
\end{mydefi}

\begin{prop}
	Los esquemas (como objetos) y los morfismos de esquemas (como flechas) conforman una categoría, denotada $\mathsf{Sch}$.
\end{prop}
\begin{prop}
	Sea $(X, \mathscr{O}_X)$ un esquema y $U \subseteq X$ un abierto. Entonces $(U, \mathscr{O}_X|_U )$ también es un esquema.
\end{prop}
\begin{proof}
	Claramente $(U, \mathscr{O}_X|_U )$ es un espacio localmente anillado, veamos que cada punto posee un entorno que es un esquema afín.
	Sea $x \in U$ un punto, luego posee un entorno $x \in V \subseteq X$ tal que $(V, \mathscr{O}_X|_V )$ es isomorfo a un esquema afín $\Spec A$.
	Luego $V \cap U$ es un entorno de $x$ en $V$ y admite un subentorno de la forma $\DD(f ) =: W$ para algún $f \in A$.
	El par $(W, \mathscr{O}_X|_W)$ es un esquema afín, pues $W \cong \Spec(A[1/f ])$ y $W \subseteq U$ es abierto.
\end{proof}

\begin{prop}\label{thm:compatible_morphs_glue}
	Sean $X, Y$ esquemas, sea $\{ U_i \}_{i\in I}$ un cubrimiento abierto de $X$.
	Dada una familia de morfismos de esquemas $f_i \colon U_i \to Y$ donde los $f_i$'s son compatibles
	(es decir, $f_i|_{U_i \cap U_j} = f_j|_{U_i \cap U_j}$ para cada $i, j \in I$), entonces existe un único morfismo de esquemas $f \colon X \to Y$.
\end{prop}
\begin{cor}
	Si $U \subseteq X$ es un abierto (no vacío) de un esquema, entonces la inclusión $\iota \colon U \hookto X$ es un encaje abierto de esquemas.
\end{cor}

\begin{thm}\label{thm:hom_aff_sch}
	Sean $X, Y$ esquemas donde $Y = \Spec A$. Entonces existe una biyección natural entre
	$$ \Hom_{\mathsf{Sch}} (X, \Spec A) \longrightarrow \Hom_{\mathsf{Ring}} (A, \Gamma(X, \mathscr{O}_X )). $$
\end{thm}
\begin{proof}
	Claramente, dado un morfismo de esquemas $(f, f^\sharp ) \colon X \to \Spec A$, entonces da un morfismo de haces sobre $\Spec A$ dado por
	$f^\sharp \colon \mathscr{O}_{\Spec A} \to f_* \mathscr{O}_X$, mirando secciones globales obtenemos un homomorfismo de anillos.

	Ahora bien, sea $X = \bigcup_{i\in I} U_i$ donde cada $U_i$ es un abierto afín, entonces tenemos el siguiente diagrama:
	\begin{center}
		\begin{tikzcd}
			\displaystyle
			\Hom_{\mathsf{Sch}}(X, Y) \rar["\rho"] \dar["\alpha"', hook] & \Hom_{\mathsf{Ring}}(A, \Gamma(X, \mathscr{O}_X)) \dar["\beta"] \\
			\prod_{i\in I} \Hom_{\mathsf{Sch}}(U_i, Y) \rar["\gamma"] \rar[draw=none, "\sim"'] & \prod_{i\in I} \Hom_{\mathsf{Ring}}(A, \Gamma(U_i, \mathscr{O}_X))
		\end{tikzcd}
	\end{center}
	Aquí $\gamma$ es una biyección por tratarse de morfismos entre esquemas afínes, y $\alpha$ es inyectivo por el axioma de pegado de esquemas,
	luego $\rho$ también es inyectivo.
	Sea $\varphi \colon A \to \mathscr{O}_X(X)$ un homomorfismo de anillos, entonces componiendo:
	\begin{center}
		\begin{tikzcd}[sep=large]
			A \rar["\varphi"'] \ar[rr, "\varphi_i", bend left] & \mathscr{O}_X(X) \rar["\rho^X_{U_i}"'] & \mathscr{O}_X(U_i)
		\end{tikzcd}
	\end{center}
	Obtenemos una familia de homomorfismos $\varphi_i \colon A \to \mathscr{O}_X (U_i)$ que son compatibles,
	luego inducen una familia de morfismos de esquemas $\varphi^a_i \colon U_i \to Y$ compatibles que pegamos en un morfismo $f$
	por la proposición anterior, y satisface que $\rho(f) = \varphi$.
\end{proof}
\begin{cor}
	Para todo esquema $(X, \mathscr{O}_X)$ existe un único morfismo de esquemas $(f, f^\sharp ) \colon X \to \Spec\Z$.
	En resumen, $\Spec\Z$ es el objeto final de $\mathsf{Sch}$.
\end{cor}

\begin{prop}\label{thm:amalg_sum_sch}
	Sean $(X, \mathscr{O}_X), (Y, \mathscr{O}_Y)$ un par esquemas, y $U \subseteq X, V \subseteq Y$ abiertos.
	Dado un isomorfismo de esquemas
	$$ \varphi \colon (U, \mathscr{O}_X|_U) \longrightarrow (V, \mathscr{O}_Y|_V) $$
	entonces admite un coproducto fibrado $X \amalg_\varphi Y =: Z$ que también es un esquema.
	Tenemos el siguiente diagrama conmutativo (en $\mathsf{Sch}$):
	% https://q.uiver.app/#q=WzAsNCxbMCwwLCJVXFxjb25nIFYiXSxbMCwxLCJZIl0sWzEsMCwiWCJdLFsxLDEsIlhcXGFtYWxnX1xcdmFycGhpIFkiXSxbMCwxLCJWIiwyXSxbMCwyLCJVIl0sWzEsMywiIiwyLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV0sWzIsMywiIiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV0sWzMsMCwiIiwxLHsic3R5bGUiOnsibmFtZSI6ImNvcm5lci1pbnZlcnNlIn19XV0=
	\[\begin{tikzcd}
		{U\cong V} & X \\
		Y & {X\amalg_\varphi Y}
		\arrow[open, "V"', from=1-1, to=2-1]
		\arrow[open, "U", from=1-1, to=1-2]
		\arrow[dashed, from=2-1, to=2-2]
		\arrow[dashed, from=1-2, to=2-2]
		\arrow["\ulcorner"{anchor=center, pos=0.125, rotate=180}, draw=none, from=2-2, to=1-1]
	\end{tikzcd}\]
\end{prop}
\begin{proof}
	Explicitaremos la construcción.
	El espacio topológico de $Z$ es el espacio topológico dado por el cociente de la suma de espacios $X \amalg Y$
	bajo la relación $x \sim \varphi(x)$ para $x \in U$.
	Esto determina dos aplicaciones $i \colon X \to Z, j \colon Y \to Z$ con la condición de que $W \subseteq Z$ es abierto syss
	$i^{-1}[W] \subseteq X$ y $j^{-1}[W] \subseteq Y$ son abiertos.
	Para un abierto $W \subseteq Z$, denotemos $U' := i^{-1}[W], V' := j^{-1}[W]$, entonces sus secciones son:
	$$ \Gamma(W, \mathscr{O}_Z) := \{ (s_1, s_2 ) \in \mathscr{O}_X(U') \times \mathscr{O}_Y(V') : \varphi(s_1|_{U \cap U'}) = s_2|_{V \cap V'} \}. $$
	Finalmente, es fácil verificar que $(Z, \mathscr{O}_Z)$ es un espacio localmente anillado, y cada punto de $Z$ está contenido en una copia
	de $X$ o de $Y$, de modo que posee un entorno que es un esquema afín.
\end{proof}
Nótese que la prueba también funciona para diagramas posiblemente infinitos.
Si dejamos que $U = V = \emptyset$, entonces obtenemos un coproducto en el sentido usual.

\begin{ex}
	Sea $A$ un anillo arbitrario, entonces $X := \coprod_{\N} \Spec A$ es un esquema,
	cuyo espacio topológico es una suma infinita de espacios no vacíos, luego no es compacto.
	Como todo esquema afín es compacto, entonces $X$ no es afín.

	Si $A = k$ es un cuerpo, podemos describir más en detalle al esquema $X$.
	Como $\Spec k = \{ x_0 \}$, entonces fácil verificar que para un abierto $U \subseteq X$ (que solo es un conjunto de puntos),
	se cumple que $\Gamma(U, \mathscr{O}_X) = \prod_{x \in U} k$, y la restricción entre abiertos equivale a borrar coordenadas.
\end{ex}
El ejemplo~\ref{thm:plane_without_origin} da otro esquema que no es afín.
% \begin{cor}
% 	La categoría de esquemas es cocompleta.
% \end{cor}
% \begin{proof}
% 	Esto debido a que tiene un objeto inicial (el esquema vacío $\emptyset$) y posee coproductos,
% 	luego es finitamente cocompleta (cfr. [13, teo. 2.12]) y entonces posee conúcleos.
% 	Como posee objeto inicial, conúcleos y coproductos infinitos, entonces es cocompleta (cfr. [13, teo. 2.11]).
% \end{proof}

Con esto podemos convertir al espectro homogéneo $\Proj A$ en un esquema:
\begin{prop}
	Sea $A$ un anillo graduado. Existe un haz $\mathscr{O}_{\Proj A}$ sobre $\Proj A$ de modo que para todo $f \in A$ homogéneo
	se cumpla que
	$$ \Gamma(\DD_+(f), \mathscr{O}_{\Proj A}) \cong A_{(f)}. $$
\end{prop}
\begin{proof}
	Como indica el enunciado, para $f \in A$ homogéneo definamos $\Gamma(\DD_+(f ), \mathscr{O}_{\Proj A}) := A_{(f)}$.
	Si $g \in A$ es homogéneo tal que $\DD_+(f ) \supseteq \DD_+(g)$ entonces, la proposición 3.29 nos da la restricción
	$\mathscr{O}_{\Proj A}(\D_+(f )) = A_{(f)} \to A_{(g)} = \mathscr{O}_{\Proj A}(\DD_+(g))$.
	Esto determina un prehaz sobre la base $\mathcal{B}$ de abiertos principales, lo que, por la misma proposición, determina un haz;
	y se extiende de manera única a un haz sobre $\Proj A$.
\end{proof}

\begin{mydef}
	Sea $A$ un anillo.
	El espacio proyectivo de dimensión $n$ sobre $A$, denotado $\PP^n_A$, es el esquema $\Proj(A[t_0, \dots, t_n])$.
\end{mydef}
\begin{exn}
	Como $\{ \DD_+(t_i) \}^n_{i=0}$ es un cubrimiento finito por abiertos de $\Proj(A[t_0, \dots, t_n]) = \PP^n_A$ , y como
	$A[t_0, \dots, t_n]_{(t_i )} \cong A[t_0/t_i, \dots , t_n/t_i]$, por ello es común ver la descripción de que $\PP^n_A$ es el esquema
	que resulta de pegar $\Spec(A[t_0/t_i, \dots, t_n/t_i])$.
\end{exn}

Ahora, la función continua dada por la proposición 3.30 se traduce en los siguientes enunciados:
\begin{prop}
	Sean $A, B$ un par de anillos graduados, y sea $\varphi \colon A \to B$ un homomorfismo de anillos graduados.
	Sea $M := (A_+)^e = \varphi[A_+]B$, entonces induce un morfismo de esquemas $\varphi^a \colon \DD_+(M ) \to \Proj A$
	tal que para todo $g \in A$ homogéneo se cumple que $(\varphi^a )^{-1}[\DD_+(g)] = \DD_+(\varphi(g))$ y
	que $\varphi^a|_{\DD_+(g)}$ coincide con el morfismo inducido por $A_{(g)} \to B_{(\varphi(g))}$.
\end{prop}
\begin{prop}
	Sea $A$ un anillo y $\mathfrak{a} \nsle A[t_0, \dots, t_n]$ un ideal homogéneo, 
	de modo que $B := A[t_0, \dots, t_n]/\mathfrak{a}$ es una $A$-álgebra graduada.
	Entonces $\Proj B$ es isomorfo a un subesquema cerrado de $\PP^n_A$ con espacio topológico $\VV_+(\mathfrak{a})$.
\end{prop}

\begin{mydef}
	Sea $A$ un anillo. Un \strong{esquema proyectivo}\index{esquema!proyectivo} sobre $A$ es un $A$-esquema isomorfo a un subesquema cerrado de $\PP^n_A$.
\end{mydef}
Acabamos de ver que toda $A$-álgebra graduada de tipo finito $B$ es tal que su espectro homogéneo es un $A$-esquema proyectivo.

\begin{mydef}
	Sea $S$ un esquema fijo. Decimos que $X$ es un esquema sobre $S$ o \strong{$S$-esquema}\index{Sesquema@$S$-esquema} si
	es morfismo de esquemas $\pi \colon X \to S$, a éste morfismo le llamaremos morfismo estructural.
	Si $A$ es un anillo, decimos que $X$ es un esquema sobre $A$ si es un esquema sobre $\Spec A$.
	Un morfismo entre un par $X, Y$ de esquemas sobre $S$ es un diagrama conmutativo (en $\mathsf{Sch}$):
	\begin{center}
		\begin{tikzcd}[row sep=large]
			X \dar["f"'] \rar & S \dar[equals] \\
			Y            \rar & S
		\end{tikzcd}
	\end{center}
	Los esquemas sobre $S$ forman una categoría (de corte), denotada $\mathsf{Sch}/S$.
\end{mydef}

\begin{cor}
	Sea $A$ un anillo.
	Los $A$-esquemas son esquemas dotados de un haz de $A$-álgebras.
\end{cor}
Ésta definición debería hacer eco de la definición de una $A$-álgebra. Trivialmente todo esquema es un esquema sobre $\Z$.

\begin{thm}\label{thm:sch_extendend_vars}
	Sea $k$ un cuerpo algebraicamente cerrado.
	Existe un funtor canónico plenamente fiel $t \colon \mathsf{Var}_k \to \mathsf{Sch}/k$.
	Más aún, una variedad $V$ es homeomorfa a los puntos cerrados de $F(V)$ y su anillo de funciones regulares
	es homeomorfo al dado por la restricción del haz estructural al subespacio de los puntos cerrados.
\end{thm}
\begin{proof}
	Sea $X$ un espacio topológico cualquiera, entonces $t(X)$ es el conjunto de los cerrados no vacíos irreducibles de $X$.
	En ésta demostración emplearemos, sin citar, las propiedades de los conjuntos irreducibles vistas en \S\ref{sec:irred_spaces}.
	Se puede verificar que si $(F_i)_{i\in I}$ son subconjuntos cerrados de $X$, entonces:
	\begin{enumerate}
		\item Si $F_1 \subseteq F_2$, entonces $t(F_1) \subseteq t(F_2)$. En particular, $t(F) \subseteq t(X)$.
		\item $t(F_1 \cup F_2 ) = t(F_1) \cup t(F_2)$.
		\item $t\left( \bigcup_{i\in I} F_i \right) = \bigcap_{i\in I} t(F_i)$.
	\end{enumerate}
	En consecuencia, los conjuntos de la forma $t(F)$ forman los cerrados de una topología sobre $t(X)$.

	Dada una función continua $f \colon X \to Y$, definimos
	\begin{align*}
		t(f) \colon t(X) &\longrightarrow t(Y) \\
		t(F) &\longmapsto \left\{ \overline{f[G]} : G \in t(F) \right\}.
	\end{align*}
	Para un espacio topológico $X$ podemos definir $\alpha \colon X \to t(X)$ dado por $\alpha(P) := \overline{\{ P \}}$.
	Y $\alpha^{-1}[-]$ determina una biyección entre abiertos de $t(X)$ y abiertos de $X$, pues:
	$$ t(X) \setminus t(F ) \longmapsto \alpha^{-1}\big[ t(X) \setminus t(F ) \big] = X \setminus F. $$
	En consecuente, $\alpha$ es continua.
	Sea $V$ una variedad sobre $k$ y sea $\mathscr{O}_V$ su haz de funciones regulares, entonces construimos el $k$-espacio localmente anillado
	$\big( t(V), \alpha_*\mathscr{O}_V \big)$.

	Sea $V$ una variedad afín sobre $k$, y sea $k[V ] := A$ su anillo de coordenadas afínes, entonces definimos
	\begin{align*}
		\beta \colon V &\longrightarrow \Spec(k[V]) \\
		P &\longmapsto \mathfrak{m}_{V, P},
	\end{align*}
	ésta aplicación determina una biyección entre $V$ y $\mSpec( k[V] )$, y más aún, determina un homeomorfismo entre ambos, luego es continua.
	Denotemos $X := \Spec( k[V] )$.
	Sea $\mathfrak{a} \nsle k[V ]$ un ideal de funciones regulares, luego $\beta^{-1}[\DD_X(\mathfrak{a})] = \DD_V(\mathfrak{a})$, es decir,
	es el conjunto de puntos que no se anulan en elementos de $\mathfrak{a}$.
	Luego podemos construir el morfismo $\beta^\sharp \colon \mathscr{O}_X \to \beta_*\mathcal{O}_V$ bajo
	la regla de que para $\mathfrak{a} \nsle k[V ]$:
	$$ \beta^\sharp \colon \Gamma(X \setminus \VV(\mathfrak{a}), \mathscr{O}_X ) \longrightarrow \Gamma(V \setminus \VV(\mathfrak{a}), \mathcal{O}_V ), $$
	dado por la evaluación. Finalmente, es fácil comprobar que $(\beta, \beta^\sharp)$ determina un isomorfismo de espacios localmente anillados,
	así que $\big( t(V), \alpha_*\mathcal{O}_V \big)$ es un esquema afín.

	Como toda variedad admite una base por abiertos afínes, entonces $\big(t(V ), \alpha_*\mathcal{O}_V \big)$ siempre resulta ser un esquema.
	Dadas dos variedades $V, W$ sobre $k$ y un morfismo de variedades $f \colon V \to W$ entre ellos, entonces podemos construir un
	morfismo de esquemas $(t(f ), t(f )^\sharp ) \colon t(V ) \to t(W )$ entre ellos con construcciones similares a las anteriores
	(donde $t(f)^\sharp$ mandará secciones sobre $W$ a secciones sobre $V$, mediante precomposición por $f$).
	Se puede verificar que ésta construcción da lugar a una biyección:
	$$ \Hom_{\mathsf{Var}_k}(V, W ) \longrightarrow \Hom_{\mathsf{Sch}/k}(t(V), t(W )) $$
	que es de hecho natural, luego $t(-)$ es plenamente fiel (cfr. \cite{CatTh}, prop. 1.11).
	
	Finalmente, $t(V)$ es un esquema sobre $k$, donde el morfismo de esquemas viene inducido por el homomorfismo de anillos
	$k \to \Gamma\big( t(V), \alpha_* \mathcal{O}_V \big) = \mathcal{O}_V(V)$
	que a cada $\lambda \in k$ lo manda a la función regular constante sobre $V$.
\end{proof}

Éste teorema nos dice que la teoría de esquemas extiende a la teoría de variedades algebraicas.
Como ejercicio para el lector, ¿dónde empleamos que $k$ sea algebraicamente cerrado? ¿Qué sucede con el funtor si $k$ no fuera algebraicamente cerrado?
\begin{mydef}
	Sea $k$ un cuerpo. Un $k$-esquema $X$ se dice un:
	\begin{description}
		\item[Esquema algebraico afín]\index{esquema!algebraico!afín} Si es el espectro de una $k$-álgebra de tipo finito.
		\item[Esquema algebraico]\index{esquema!algebraico} Si cada punto posee un entorno que es un conjunto algebraico afín.
		\item[Esquema algebraico proyectivo]\index{esquema!algebraico!proyectivo} Si es un $k$-esquema proyectivo.
	\end{description}
\end{mydef}

\subsection{Propiedades de esquemas}
Comencemos por dar un par de definiciones:
\begin{mydef}
	Un espacio topológico $X$ se dice \strong{cuasiseparado}\index{espacio!cuasiseparado} si la intersección de todo par de abiertos compactos es compacto.
	\par
	Un esquema $X$ se dice \strong{compacto}\index{compacto} (resp. \strong{cuasiseparado}, \strong{conexo}, \strong{irreducible})
	si su espacio topológico es compacto (resp. cuasiseparado, conexo, irreducible).
\end{mydef}
Por ejemplificar, los espacios topológicos noetherianos son compactos y cuasiseparados.

\begin{prop}\label{thm:qcqs}
	Sea $X$ un esquema y $f \in \Gamma(X, \mathscr{O}_X )$ una sección global. Denótese
	$$ X_f := \{ x \in X : f|_x \notin \mathfrak{m}_{X,x} \subseteq \mathscr{O}_{X,x} \} = \{ x \in X : \mathscr{O}_{X,x} = f|_x \mathscr{O}_{X,x} \}. $$
	Entonces:
	\begin{enumerate}
		\item Si $\Spec B \cong U \subseteq X$ es un subesquema abierto afín y $\overline{f} := f|_U \in B \cong \Gamma(U, \mathscr{O}_X)$,
			entonces $U \cap X_f = \DD_B(\overline{f})$. En consecuencia, $X_f$ es abierto en $X$.
		\item Si $X$ es compacto, entonces para todo $a \in A := \Gamma(X, \mathscr{O}_X )$ se cumple que $a|_{X_f} = 0$ syss
			$f^n a = 0$ para algún $n \in \N$.
			% Suponga que $X$ posee un cubrimiento finito por abiertos afínes $\{ U_i \}^n_{i=1}$ tales que cada $U_i \cap U_j$ es compacto
			% (e.g., si X es un espacio topológico noetheriano).
		\item Si $X$ es cuasiseparado,
			entonces para todo $b \in \Gamma(X_f, \mathscr{O}_X)$ existe $a \in A$ tal que $a|_{X_f} = f^n b$ para algún $n \in \N$.
			Más aún, $\Gamma(X_f, \mathscr{O}_X) \cong A[1/f ]$.
	\end{enumerate}
\end{prop}
\begin{mydef}
	Un esquema $(X, \mathscr{O}_X)$ se dice \strong{reducido}\index{esquema!reducido} si para cada abierto $U \subseteq X$, el anillo $\mathscr{O}_X(U)$
	es reducido (i.e., no posee nilpotentes).
	Un esquema se dice \strong{íntegro}\index{esquema!integro@íntegro} si para cada abierto no vacío $U \subseteq X$, el anillo $\mathscr{O}_X(U )$ es
	un dominio íntegro (no nulo).
\end{mydef}

\begin{prop}\label{thm:generic_pts}
	Sea $(X, \mathscr{O}_X)$ un esquema.
	\begin{enumerate}
		\item Un punto $\xi$ de $X$ es genérico syss $\overline{\{ \xi \}}$ es una componente irreducible de $X$.
			En consecuencia, hay una biyección entre puntos genéricos y componentes irreducibles de $X$.
		\item Para todo punto $x \in X$, las componentes irreducibles de $\Spec(\mathscr{O}_{X, x})$ están en biyección con
			las componentes irreducibles de $X$ que contienen a $x$.
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item Sea $F$ una componente irreducible de $X$ y sea $U \subseteq F$ un abierto afín no vacío.
			Nótese que $U$ es denso por el teorema \ref{thm:open_in_irred_sp} y es irreducible,
			luego posee un único punto genérico $\xi \in U$ por la proposición \ref{thm:generic_in_spec} tal que $\overline{\{ \xi \}} = U = F $.
			Si $F$ tuviese otro punto denso $\eta$, entonces éste cortaría a todo abierto de $F$, en particular, $\eta \in U$ sería denso,
			luego $\eta = \xi$ y se comprueba que $\xi$ es punto genérico de $F$ y de $X$.

		\item Sea $x$ arbitrario y sea $U$ un entorno afín de $x$, de modo que $\mathscr{O}_{X, x} = (\mathscr{O}_X|_U)_x$,
			lo que nos reduce al caso afín.
			Luego podemos considerar a $x$ como un primo y luego los puntos genéricos son los primos minimales que están contenidos
			en $\mathfrak{p}_x$ por la proposición \ref{thm:generic_in_spec}. \qedhere
	\end{enumerate}
\end{proof}
\begin{cor}
	Un esquema irreducible posee un único punto genérico que, además, resulta ser denso.
\end{cor}

\begin{prop}\label{thm:reduced_subsch}
	Sea $(X, \mathscr{O}_X)$ un esquema, entonces:
	\begin{enumerate}
		\item $X$ es reducido syss cada anillo local $\mathscr{O}_{X, x}$ es reducido.
		\item Sea $\mathscr{O}_{ X_{\rm red} }$ la hazificación del prehaz $U \mapsto \Gamma(U, \mathscr{O}_X)_{\rm red}$.
			Entonces $(X, \mathscr{O}_{ X_{\rm red} })$ es un esquema reducido, que denotaremos $X_{\rm red}$.
			Más aún, existe un morfismo de esquemas canónico $(f, f^\sharp ) \colon X_{\rm red} \to X$ tal que $f$ es un homeomorfismo.
		\item Sea $g \colon X \to Y$ un morfismo de esquemas.
			Entonces existe un único morfismo $ḡ_{\rm red} \colon X_{\rm red} \to Y_{\rm red}$ tal que el siguiente diagrama conmuta:
			\begin{center}
				\begin{tikzcd}[row sep=large]
					X_{\rm red} \rar["\exists!g_{\rm red}", dashed] \dar & Y_{\rm red} \dar \\
					X           \rar["g"]                                & Y
				\end{tikzcd}
			\end{center}

			En consecuencia, $(-)_{\rm red} \colon \mathsf{Sch} \to \mathsf{Sch}$ es un funtor covariante.
			Denotando por $\mathscr{R}$ la subcategoría plena de esquemas reducidos y denotando $\iota \colon \mathscr{R} \to \mathsf{Sch}$
			el funtor inclusión, tenemos que $(-)_{\rm red} \adjoint \iota$.

		\item Sea $Z$ un cerrado de $X$.
			Existe un único haz de anillos sobre $Z$ tal que $Z$ es un subesquema cerrado reducido de $X$.
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item $\implies.$ Sea $x \in X$ un punto y $s \in \mathscr{O}_{X, x}$ un gérmen local no nulo.
			Luego, $s^n = 0$ syss existe una sección $t \in \Gamma(U, \mathscr{O}_X)$ sobre un entorno $U$ de $x$, tal que $t|_x = s$ y $t^n = 0$,
			pero dicha sección no existe por que $X$ es reducido.

			$\impliedby.$ Sea $s \in \Gamma(U, \mathscr{O}_X)$ una sección no nula tal que $s^n = 0$. Entonces
			como $s ̸= 0$, existe $x \in U$ tal que el gérmen $s|_x ̸= 0$ y $s^n|_x = 0$, lo que es absurdo pues los anillos locales son reducidos.

		\item Para todo anillo, tenemos el homomorfismo de anillos $\pi \colon A \to A/\nilrad = A_{\rm red}$
			que induce $\pi^a \colon \Spec(A_{\rm red}) = (\Spec A)_{\rm red} \to \Spec A$.
			Pegando estos morfismos de esquemas, pues son compatibles, obtenemos el morfismo $X_{\rm red} \to X$.
		\item Ejercicio para el lector.
		\item Sea $U$ un abierto afín sobre $X$, luego $Z\cap U$ es un cerrado en $U$, por ende,
			$\mathscr{O}_Z(Z \cap U ) = \mathscr{O}_X(U)/\mathfrak{a}$ para algún $\mathfrak{a} \nsle \mathscr{O}_X(U)$,
			donde $Z \cap U = \VV_U(\mathfrak{a})$.
			Si $Z$ es reducido, entonces $\mathfrak{a}$ debe ser radical.
			Si $\mathscr{O}_Z (Z \cap U )$ tuviese otra estructura sería de la forma $Z \cap U = \VV(\mathfrak{b})$,
			donde $\mathfrak{b} = \rad\mathfrak{b} = \rad\mathfrak{a} = \mathfrak{a}$ por el teorema~\ref{thm:ring_nullstellensatz}.
			Para probar la existencia, basta elegir $U_i$ un cubrimiento de $X$ por abiertos afínes y dado $Z \cap U_i = \VV_U(\mathfrak{a}_i)$,
			podemos definir $\mathscr{O}_Z (Z \cap U_i) := \mathscr{O}_X(U_i)/\rad\mathfrak{a}_i$. \qedhere
	\end{enumerate}
\end{proof}
El funtor de reducción $(-)_{\rm red}$ será importante más adelante y su mención no es puramente estética.

\begin{prop}
	Un esquema es íntegro syss es reducido e irreducible.
\end{prop}
\begin{proof}
	$\implies.$ Claramente un esquema íntegro es reducido.
	Si $X$ no fuera irreducible, entonces existirían dos abiertos $U_1, U_2$ no vacíos disjuntos, luego nótese que $\mathscr{O}_X(U_1 \cup U_2)
	\cong \mathscr{O}_X(U_1) \times \mathscr{O}_X(U_2)$ por proposición~\ref{thm:amalg_sum_sch}, el cual no es un dominio íntegro.

	$\impliedby.$ Sea $U$ un abierto de $X$ y sean $f, g \in \mathscr{O}_X(U)$ tales que $fg = 0$.
	Entonces sean $Y := \{ x \in U : f|_x \in \mathscr{m}_{X, x} \}$ y $Z := \{ x \in U : g|_x \in \mathfrak{m}_{X, x} \}$ subconjuntos cerrados,
	por la proposición~\ref{thm:qcqs}, de $U$ e $Y \cup Z = U$.
	Como $X$ es irreducible, entonces $U$ también, por lo que alguno de los dos conjuntos $Y, Z$ es $U$.
	Digamos que $Y = U$, entonces $f|_x \in \mathfrak{m}_{X, x}$ para todo $x \in U$, luego eligiendo un abierto afín $V = \Spec A$,
	entonces vemos que $\emptyset = V \cap U_f = \DD_A(f)$, luego es fácil notar que $f|_V$ debe ser nilpotente, pues $f$ está contenido en todos los
	primos de $A$ y $\nilrad(A) = \bigcap_{\mathfrak{p} \in \Spec A} \mathfrak{p}$ por el teorema~\ref{app:radical}.
	Pero como $f|_V$ es nilpotente y $A$ es reducido, entonces $f|_V = 0$ para todos los abiertos afínes, luego $f = 0$ como se quería probar.
\end{proof}
Por la proposición~\ref{thm:generic_pts}, entonces todo esquema íntegro posee un único punto genérico.

\begin{cor}\label{thm:integral=loc_int+connected}
	Un esquema es íntegro syss es conexo y cada anillo local $\mathscr{O}_{X, x}$ es un dominio íntegro.
\end{cor}
\begin{proof}
	$\implies.$ Trivial.

	$\impliedby.$ Sea $U = \Spec A$ un abierto afín no vacío.
	Sea $\xi$ un punto genérico de $U$, entonces $A_\xi$ es un anillo local artiniano y es un dominio íntegro, luego es un cuerpo
	(teorema~\ref{app:artinian_integral}), por lo que, $\xi = (0)$ es primo y $A$ es un dominio íntegro.
	Ahora veamos que $\mathscr{O}_X(X)$ es íntegro; si $fg \in \mathscr{O}_X(X)$ son tales que $f g = 0$, entonces sin perdida de generalidad
	supongamos que $f|_U = 0$ en el abierto afín $U$.
	Sea $V$ otro abierto afín no vacío, si $V \cap U = \emptyset$, entonces $\mathscr{O}_X(V \cup U) = \mathscr{O}_X(V) \times \mathscr{O}_X(U)$,
	de modo que $V \cup U$ es un abierto afín de espectro no íntegro, lo cual es absurdo.
	Así que $V$ se corta con $U$ y como $\VV_V(f ) \supseteq U \cap V$ es denso, entonces $\VV_V(f ) = V$.
	Así que $f|_V = 0$ para todo abierto afín, y luego $f = 0$.
\end{proof}

\begin{lem}
	Sea $A$ un dominio íntegro, $K := \Frac A$ y sea $\xi := (0) \in \Spec A =: X$.
	Entonces $\mathscr{O}_{X,\xi} = K$ y para todo abierto no vacío $U \subseteq X$ se cumple que $\xi \in U$,
	de modo que el homomorfismo canónico $\mathscr{O}_X (U ) \to \mathscr{O}_{X,\xi}$ es inyectivo.
	Si $U \supseteq V ̸\ne \emptyset$ es abierto, entonces la restricción $\rho_V^U \colon \mathscr{O}_X(U ) \to \mathscr{O}_X(V)$ también es inyectiva.
\end{lem}
\begin{proof}
	Nótese que $\mathscr{O}_{X,\xi} = A(0) = K$, luego para todo $U = \DD(f)$ identificamos $\mathscr{O}_X(\DD(f)) \cong A[1/f] \subseteq K$
	lo que corresponde al homomorfismo canónico.
	Más generalmente, si $s \in \mathscr{O}_X(U)$ con $U = \bigcup_{i=1}^n \DD(f_i)$ es tal que $s|_{\DD(f_i)} = 0$, entonces $s = 0$,
	lo que da que el homomorfismo canónico $\mathscr{O}_X(U) \to K$ sea inyectivo.
	Finalmente como la composición $\mathscr{O}_X(U ) \to \mathscr{O}_X(V ) \to K$ es inyectiva, entonces $\rho_V^U$ lo es.
\end{proof}

\begin{prop}
	Sea $X$ un esquema íntegro con punto genérico $\xi$. Entonces:
	\begin{enumerate}
		\item Sea $V$ un abierto afín, entonces el homomorfismo canónico $\mathscr{O}_X (V ) \to \mathscr{O}_{X,\xi}$
			induce un isomorfismo $\Frac(\mathscr{O}_X(V)) \cong \mathscr{O}_{X,\xi}$.
		\item Para todo abierto $U \subseteq X$ y todo punto $x \in X$, los homomorfismos $\mathscr{O}_X (U ) \to \mathscr{O}_{X,x}$
			y $\mathscr{O}_{X,x} \to \mathscr{O}_{X,\xi}$ son inyectivos.
		\item Identificando $\mathscr{O}_X (U )$ y $\mathscr{O}_{X,x}$ como subanillos de $\mathscr{O}_{X,\xi}$ se tiene que:
			$$ \mathscr{O}_X (U ) = \bigcap_{x\in U} \mathscr{O}_{X, x}. $$
	\end{enumerate}
\end{prop}
\begin{proof}
	\begin{enumerate}
		\item Basta notar que $\xi \in V$ también es punto genérico de $V = \Spec A$ como esquema.
			Luego $\mathscr{O}_X(V) \cong A \to \mathscr{O}_{V,\xi} = \mathscr{O}_{X,\xi} = \Frac A$ por el lema anterior.

		\item Sea $f \in \mathscr{O}_X (U )$ tal que $f|_x = 0$, luego $f|_W = 0$ para algún entorno afín de $x$.
			Sea $V \subseteq U$ un entorno afín arbitrario de $x$, luego como $X$ es irreducible, $W \cap V ̸= \emptyset$ y como
			$f|_{W \cap V} = 0$ entonces $f|_V = 0$, pues $\mathscr{O}_X (V ) \hookto \mathscr{O}_X (V \cap W )$ es inyectiva por el lema anterior.
			Así, por axioma de pegado, $f = 0$.

			El hecho de que $\mathscr{O}_{X,x} \to \mathscr{O}_{X,\xi}$ sea inyectivo puede corroborarse pasando
			a un entorno afín de $x$, donde se reduce a notar que $A_{\mathfrak{p}} \hookto A_{(0)}$ es
			inyectivo para todo $\mathfrak{p} \in \Spec A$.

		\item Podemos reducirnos al caso afín, el cual es fácilmente verificable. \qedhere
	\end{enumerate}
\end{proof}

\begin{exn}[plano afín sin orígen]\label{thm:plane_without_origin}
	Sea $k$ un cuerpo y considere el plano afín $X := \A^2_k$.
	Ahora, considere el abierto $U := X \setminus \{ (x, y) \}$ el cual es un esquema; vamos a probar que $U$ no es un esquema afín.

	Nótese que $U = \DD(x) \cup \DD(y)$, esto es pues $\mathfrak{p} \in \DD(x)$ syss $\mathfrak{p} ̸\supseteq (x)$, y lo
	mismo con $y$, luego $\mathfrak{p} \notin U$ syss $\mathfrak{p} \subseteq (x)$ y $\mathfrak{p} \supseteq (y)$, por lo que
	$\mathfrak{p} \subseteq (x, y)$ y el punto $(x, y)$ es maximal.

	Luego considere la restricción $\rho^X_U \colon k[x, y] \to \Gamma(U, \mathscr{O}_X)$.
	Una sección $s \in \Gamma(U, \mathscr{O}_X )$ es tal que es el pegado de una sección
	$$ f(x, y) := s|_{\DD(x)} \in \Gamma(\DD(x), \mathscr{O}_X ) \cong k[x, y][1/x] $$
	y una sección $g(x, y) := s|_{\DD(y)} \in \Gamma(\DD(y), \mathscr{O}_X )$ tales que $f|_{\DD(x)\cap\DD(y)} = g|_{\DD(x)\cap\DD(y)}$.
	Como $k[x, y]$ es un dominio íntegro, entonces la restricción a abiertos es siempre inyectiva, entonces tenemos que la sección $s \in k(X) = k(x, y)$
	solo tiene como posibles denominadores múltiplos de $x$ (dados en $f$) o múltiplos de $y$ (dados en $g$), y como $f$ no tiene denominador con $y$,
	entonces $s$ tampoco.
	Así, $s \in k[x, y]$ y se ve que $\rho^X_U$ es un isomorfismo.

	Finalmente, si $U$ fuera afín, entonces $\rho^X_U \colon \mathscr{O}_X(X) \to \mathscr{O}_U(U)$ determina de forma única el morfismo de esquemas
	$\iota \colon U \to X$ que es necesariamente la inclusión, y como entre esquemas afínes el funtor $\Spec(-)$ es una equivalencia de categorías
	tendríamos que $\iota$ es un isomorfismo de esquemas, pero claramente no es suprayectivo.
\end{exn}

% \begin{exn}[el plano con dos orígenes]
% 	Sea $A$ un anillo fijo.
% 	Sean $X := Y := \A^2_A$ y sea $U := V = X \setminus \{ (x, y) \}$.
% 	Luego, aplicando la proposición~\ref{thm:amalg_sum_sch} podemos pegar $X, Y$ a través de $U \cong V$ y así obtener un esquema $Z$
% 	que llamaremos el plano con dos orígenes.
% \end{exn}

En espíritu del mismo ejemplo, haga el siguiente ejercicio:
\begin{prob}
	Sea $k$ un cuerpo y sea $\PP^n_k =: X$ un espacio proyectivo.
	Demuestre que las secciones globales son $\Gamma(\PP^n_k , \mathscr{O}_X ) = k$ y concluya que $\PP^n_k$ no es un esquema afín.
\end{prob}

\begin{thm}
	Sean $X, Y$ esquemas íntegros con puntos genéricos $\xi, \eta$ resp.
	Para un morfismo $f \colon X \to Y$ son equivalentes:
	\begin{enumerate}
		\item $f$ es dominante.
		\item $f^\sharp \colon \mathscr{O}_Y \to f_*\mathscr{O}_X$ es inyectiva.
		\item $f(\xi) = \eta$.
		\item $\eta \in f[X]$.
	\end{enumerate}
\end{thm}
\begin{proof}
	$1 \implies 2$. Supongamos, por contradicción, que existe un abierto $V \subseteq Y$ tal que
	$f^\sharp \colon \mathscr{O}_Y (V ) \to \mathscr{O}_X (f^{-1} [V ])$ no es inyectiva.
	Es decir, existe $h \in \mathscr{O}_Y (V )$ no nula, tal que $f_V^\sharp (h) = 0$.
	Como $Y$ es íntegro, las restricciones son inyectivas, luego podemos suponer que $V$ es afín, y podemos reducirnos al abierto $\DD(h)$,
	de modo que $h$ sea invertible en $\mathscr{O}_Y (V )$.

	Ahora bien, como $f$ es dominante, existe $x \in X$ tal que $f (x) \in U $.
	Luego $f_x^\sharp (h|_{f(x)} ) = 0$, pero $h|_{f (x)}$ es invertible en $\mathscr{O}_{Y,f(x)}$,
	así que $(f_x^\sharp)^{-1}[\mathfrak{_{X, x}}] = \mathscr{O}_{Y,f(x)} \supset \mathfrak{m}_{Y, f(x)}$, lo cual es absurdo.

	$2 \implies 1$. Si $f[X]$ no fuera denso, entonces existe un abierto $V \ne \emptyset$ de $Y$
	tal que $f^{-1}[V] = \emptyset$, pero el homomorfismo $f_V^\sharp \colon \mathscr{O}_Y (V ) \to 0$ no es inyectivo.

	$1 \implies 3$. Sea $V ̸\ne \emptyset$ un abierto de $Y$, entonces $f^{-1} [V ]$ es abierto y no vacío en $X$, luego es denso (pues $X$ es irreducible) y,
	por lo tanto, $\xi \in f^{-1} [V ]$, o equivalentemente, $f (\xi) \in V$.
	Así, vemos que $f(\xi)$ es denso en $Y$ y luego debe ser $\eta$.

	Las implicancias $3 \implies 4 \implies 1$ son triviales.
\end{proof}
\begin{mydef}
	Sea $X$ un esquema íntegro con único punto genérico $\xi$.
	Su \strong{cuerpo de funciones racionales}\index{cuerpo!de funciones racionales} es $K(X) := \mathscr{O}_{X,\xi}$.
	Una función racional $f \in K(X)$ se dice \strong{regular}\index{función!regular} en un punto $x \in X$ si $f \in \mathscr{O}_{X,x}$,
	o se dice \strong{regular} en un abierto $U ̸\ne \emptyset$ si $f \in \mathscr{O}_X(U)$.
\end{mydef}
El inciso 3 de la proposición anterior, ahora se escribe como que una función es regular en un abierto syss es regular en todos sus puntos.

% Proposición 3.100: Sea k un cuerpo y X un k-conjunto algebraico íntegro. Entonces para todo U \subseteq X abierto no vacío se tiene que dim U =
% dim X = trdegk k(X).
% Demostración: Como X es un esquema íntegro, entonces posee un único
% punto genérico \xi y como es denso \xi \in U , luego k(U ) = \mathscr{O}_U,\xi = \mathscr{O}_X,\xi = k(X).
% Supongamos que X = \Spec A es un esquema afín. Entonces dim X =
% \kdim A por la proposición 3.14 y \kdim A = trdegk (\Frac(A)) por el teorema A.44 y k(X) = \Frac A (¿por qué?).
% Proposición 3.101: Sea X un esquema. Entonces para todo punto x \in
% X se cumple que codim({x}, X) = \kdim(\mathscr{O}_X,x ).
% Definición 3.102: Se dice que un esquema X es catenario si tiene dimensión finita y toda cadena maximal de cerrados irreducibles tiene la misma
% longitud.
% El inciso 2 del teorema A.44 nos dice:
% Proposición 3.103: Sea k un cuerpo. Todo k-conjunto algebraico afín
% es catenario.
% Corolario 3.104: Sea k un cuerpo y X un k-conjunto algebraico afín
% irreducible. Entonces para todo punto cerrado x \in X se cumple que dim X =
% \kdim(OX,x ).

El opuesto a los puntos genéricos son los puntos cerrados.
Si localmente un punto genérico <<ve todas las funciones racionales>>, entonces localmente un punto cerrado ve muy pocas:
\begin{prop}
	Sea $k$ un cuerpo y $X$ un $k$-esquema algebraico.
	Un punto $x \in X$ es cerrado syss $\kk(x)$ es una extensión finita de $k$.
	En particular, si $k$ es algebraicamente cerrado, entonces $x \in X$ es cerrado syss $\kk(x) = k$.
\end{prop}
\begin{proof}
	Basta notar que en una carta afín un punto es cerrado syss corresponde a un ideal maximal (corolario~\ref{thm:spec_closure}),
	luego su cociente es una extensión de cuerpos de $k$.
	Como en un conjunto algebraico, las cartas afínes son $k$-álgebras de tipo finito, entonces los puntos cerrados tienen cuerpos de
	restos $\kk(x)$ que son extensiones de cuerpo de $k$ de tipo finito, por lo que, por
	el lema de Zariski, deben ser extensiones finitas de cuerpo.
\end{proof}

\begin{mydef}
	Sea $k$ un cuerpo y $X$ un $k$-esquema algebraico. Denotamos por $\clpt X$ a los puntos cerrados de $X$.
\end{mydef}

\begin{cor}
	Sea $k$ un cuerpo y $X$ un $k$-esquema algebraico. Se cumplen:
	\begin{enumerate}
		\item $\clpt X ̸\ne \emptyset$.
		\item Para todo $U \subseteq X$ abierto se cumple que $\clpt U = U \cap \clpt X$.
		\item $\clpt X$ es un subconjunto denso de $X$.
	\end{enumerate}
\end{cor}
\begin{proof}
	Basta notar que cada carta afín admite un punto cerrado, y la proposición anterior nos da un criterio global para detectar puntos
	cerrados. Más aún, como cada abierto afín siempre posee puntos cerrados,
	entonces $\clpt X$ corta a cada abierto no vacío.
\end{proof}
Este corolario será fuertemente mejorado en la versión esquemática del lema de Zariski (vid.\ teo.~\ref{thm:scheme_zariski_lemma}).

\begin{prop}\label{thm:qc_sch_many_closed_pts}
	Sea $X$ un esquema compacto.
	Entonces, todo punto $x \in X$ se especializa $x \speto s$ en un punto cerrado.
\end{prop}
\begin{proof}
	Como todo cerrado es un esquema compacto, basta probar que $X$ posee un punto cerrado.
	Como $X$ es compacto, entonces se cubre por finitos abiertos afines $U_i = \Spec(A_i)$.
	Podemos elegir ésta expresión de modo que sea irredundante, vale decir, tal que $U_i \nsubseteq U_j$ con $i \ne j$,
	para ello, si tenemos una inclusión $U_i \subseteq U_j$ eliminamos a $U_i$.
	Elijamos un punto $s \in U_1 \setminus \left( \bigcup_{j=2}^n U_j \right)$ y que sea cerrado en $U_1$ (es decir, maximal),
	como $s \in \left( \bigcup_{j=2}^n U_j \right)^c$, el cual es cerrado en $X$, entonces $ \overline{\{ s \}} \cap \left( \bigcup_{j=2}^{n} U_j \right)^c$
	también es cerrado en $X$.
	Finalmente, es fácil verificar que si un punto $y \in \overline{\{ s \}}$, entonces debe estar en $U_1$,
	luego $y = s$ y así, vemos que $s$ es cerrado como se quería probar.
	% para ello reemplazamos $U_i \cap (\bigcup_{j\ne i} U_j)$
	% % Esencialmente, emplearemos el hecho de que <<ser cerrado>> puede verificarse localmente.
	% Reordenemos la lista de modo que $x \in U_i$ con $1 \le i \le n$, pero $x \notin U_j$ con $n < j \le m$.
	% Así pues $x \in \left( \bigcup_{j=n+1}^{m} U_j \right)^c$ que es cerrado y podemos hacer verificaciones de ser cerrado aquí.
	% \par
	% De la lista, borraremos aquellos que no contienen a $x$; así que $x \in \bigcap_{i=1}^{n} U_i$ y, por la proposición anterior,
	% sea $V = \Spec A$ un entorno de $x$ que es un abierto principal de cada $U_i$ (esto se logra por finitud de los $U_i$'s).
	% Así, vemos a $x$ como un primo $\mathfrak{p}$ de $A$ y, luego, se especializa en un ideal maximal $\mathfrak{m}$ de $A$,
	% que se corresponde a un punto $s \in V$.
	% \par
	% \underline{Veamos que $s$ es cerrado:}
	% sea $y \in X$ tal que $y \in \overline{\{ s \}}$, es decir, $y$ pertenece a todo entorno de $s$ y, en particular, pertenece a $V$.
	% Así $y \in V \cap \overline{\{ s \}} = \overline{\{ s \}}_V = \{ s \}$ como se quería probar.
	% Consideremos $F := \overline{\{ x \}}$, este conjunto es un cerrado irreducible y es fácil notar que si $U_i$
	% es un entorno afín de $x$, entonces $U \supseteq F$.
	% Sea $\mathfrak{p}_i$ el primo correspondiente a $x$ en $U_i$, luego se especializa en cada abierto a un ideal maximal $\mathfrak{m}_i \in \Spec(A_i)$
	% Mirando al punto $x \in U_i$
	% Sea $X$ compacto. Diremos que un subespacio $S$ posee la propiedad $\mathcal{P}$ si todo cerrado $F \subseteq S$ no vacío contiene un punto cerrado.
	% Como los abiertos afínes poseen la propiedad $\mathcal{P}$ y finitos de éstos cubren a $X$, entonces basta probar que si $U, V$ son abiertos
	% que poseen $\mathcal{P}$, entonces $U \cup V$ posee $\mathcal{P}$.
	% \par
	% Supongamos que $X = U \cup V$, donde $U, V$ poseen $\mathcal{P}$ y donde $U \nsubseteq V$.
	% Luego $U \setminus V ̸= \emptyset$ es un cerrado en $U$, por lo que posee un punto $x \in U \setminus V$ cerrado en $U$.
	% Si $x$ es cerrado en $X$, estamos listos; si no $\overline{\{ x \}} \cap U = \overline{\{ x \}}$ y $\overline{\{ x \}} \cap V$ es un cerrado en $V$
	% que posee un punto $y$ cerrado en $V$.
	% Entonces $\overline{\{ y \}} \cap V = \overline{\{ y \}}$ y $\overline{\{ y \}} \cap U \subseteq \overline{\{ x \}} \cap U = \overline{\{ x \}}$,
	% pero $x \notin \overline{\{ y \}}$ porque $U$ es un entorno de $x$ que no corta a $\overline{\{ y \}}$, así que $\overline{\{ y \}} = \{ y \}$
	% como se quería probar.
\end{proof}
El paso clave en la demostración, el uso de <<compacidad>> está en el encontrar el cubrimiento irreducible.
Si el esquema no es compacto, podríamos tener un cubrimiento por abiertos afines creciente e infinito; así la unión de todos ellos seguiría siendo un abierto,
pero podría no ser afin.
En el ejemplo~\ref{exn:no_closed_points} damos una construcción de un esquema sin puntos cerrados y precisamente esto es lo que falla.

Debido a su naturaleza, los puntos, mientras más especializados, más pequeños resultan sus cuerpos de restos, de modo que son más <<sencillos>>
y así tenemos todo un espectro recorriendo desde los puntos genéricos a los cerrados.
\begin{prop}
	Sea $k$ un cuerpo, sean $X, Y$ un par de $k$-esquemas algebraicos y $f \colon X \to Y$ un morfismo de $k$-esquemas.
	Entonces $f[\clpt X] \subseteq \clpt Y$.
\end{prop}
\begin{proof}
	Basta aplicar la proposición~\ref{thm:mono_fibers}.
\end{proof}

\begin{prop}
	Sea $X$ un esquema, y sean $U, V \subseteq X$ dos abiertos afines en $X$.
	Todo punto $x \in U \cap V$ posee un entorno $W \subseteq U \cap V$ tal que $W$ es un abierto principal tanto en $U$ como en $V$.
\end{prop}
\begin{proof}
	Como los abiertos principales son una base, existe $f \in \Gamma(V, \mathscr{O}_X)$ tal que $x \in \DD_V(f) \subseteq U \cap V$.
	Nótese que $V' := \DD_V(f) \cong \Spec(V[1/f])$ y todo abierto principal $\DD_{V'}(g/f^n)$ de $V'$ corresponde a un abierto principal $\DD_V(fg)$
	de $V$, de modo que sustituyendo $V$ por $V'$ podemos suponer que $V \subseteq U$.

	Como los abiertos principales son base, existe $h \in \Gamma(U, \mathscr{O}_X)$ tal que $x \in \DD_U(h) \subseteq V$.
	Consideremos la restricción $\rho_V^U \colon \Gamma(U, \mathscr{O}_X) \to \Gamma(V, \mathscr{O}_X)$, así vemos que $\DD_U(h) = \DD_V(h|_V)$
	(¿por qué?), así que éste abierto cumple lo exigido.
\end{proof}

% \begin{mydef}
% 	Un espacio topológico $X$ se dice \strong{cuasiseparado}\index{cuasiseparado (espacio)} si la intersección de dos abiertos compactos es compacto.
% \end{mydef}
% \begin{prop}
% 	Un esquema es compacto y cuasiseparado syss puede cubrirse por finitos abiertos afínes.
% \end{prop}
% \begin{proof}
% 	$\implies .$ Trivial.

% 	$\impliedby.$ Los esquemas afínes son compactos, así que $X$ también.
% 	Para ver que $X$ es cuasiseparado, basta probar que todo esquema afín $X = \Spec A$ es cuasiseparado.
% 	Sean $U_1, U_2$ dos abiertos compactos de $X$, entonces se pueden escribir como unión finita de abiertos principales:
% 	$$ U_1 = \bigcup_{i=1}^n \DD(f_i), \qquad U_2 = \bigcup_{j=1}^{m} \DD(g_j) $$
% 	Nótese que como $\DD(f_i) \simeq \Spec(A[1/f_i])$ (en $\mathsf{Top}$), vemos que cada $\DD(f_i)$ es compacto. Luego
% 	$$ U1 \cap U2 = \bigcup_{i=1}^{n} \bigcup_{j=1}^{m} (\DD(f_i) \cap \DD(g_j)) = \bigcup_{i=1}^{n} \bigcup_{j=1}^{m} \DD(f_ig_j), $$
% 	el cual es abierto y compacto.
% \end{proof}
% Por ejemplo, los espacios topológicos noetherianos son compactos y cuasiseparados.

\begin{mydef}
	Sea $X$ un esquema.
	Se dice que una propiedad $\mathcal{P}$ de subesquemas abiertos afines es \strong{local para afines}\index{local para afines (propiedad)} si:
	\begin{enumerate}[{LAf}1.]
		\item Si $\Spec A \subseteq X$ satisface $\mathcal{P}$, entonces todo abierto principal $\Spec(A[1/f]) \subseteq X$
			también satisface $\mathcal{P}$.
		\item Supongamos que $\Spec A = \bigcup_{i=1}^{n} \DD_A(f_i) $, o equivalentemente $A = (f_1, \dots, f_n)$,
			donde cada $\DD_A(f_i)$ satisface $\mathcal{P}$.
			Entonces $\Spec A$ satisface $\mathcal{P}$.
	\end{enumerate}
\end{mydef}
\begin{lem}[comunicación afín]\index{lema!de comunicación afín}
	Sea $X$ un esquema.
	Sea $\mathcal{P}$ una propiedad local para afines en $X$.
	Si $X = \bigcup_{i\in I} U_i$, donde cada $U_i$ es un abierto afín que satisface $\mathcal{P}$,
	entonces cada abierto afín de $X$ satisface $\mathcal{P}$.
\end{lem}
\begin{proof}
	Sea $V \subseteq X$ un abierto afín.
	Luego $V = \bigcup_{i\in I} (U_i \cap V)$, pero mejor aún, cada intersección $U_i \cap V$ puede cubrirse por abiertos $U_{ij}$
	que son principales tanto en $U_i$ como en $V$ por la proposición anterior.
	Así, $V = \bigcup_{ij} U_{ij}$ y, como los esquemas afines son compactos, podemos suponer que la unión es finita.
	Por LAf1, sabemos que cada $U_{ij}$ satisface $\mathcal{P}$ y, por LAf2, concluimos que $V$ también satisface $\mathcal{P}$ como se quería probar.
\end{proof}
Éste es un metalema muy conocido que nos permitirá demostrar que varias propiedades para abiertos afines de un esquema
pueden verificarse en cubrimientos.
Éste resultado es bastante sencillo, al punto de que rara vez se menciona en un libro de geometría algebraica y se le utiliza en demasía;
la denominación <<lema de comunicación afín>> es de \citeauthor{vakil:rising_sea}~\cite{vakil:rising_sea}.

\begin{mydef}
	Un esquema $X$ se dice \strong{localmente noetheriano}\index{esquema!localmente noetheriano}
	si todo punto $x \in X$ posee un entorno afín $x \in U$ tal que $\Gamma(U, \mathscr{O}_X)$ es un anillo noetheriano.
	% si posee un cubrimiento por esquemas afínes $\Spec(A_i)$, donde cada $A_i$ es un anillo noetheriano.
	Un esquema se dice \strong{noetheriano}\index{esquema!noetheriano} si es localmente noetheriano y compacto, o equivalentemente,
	si posee un cubrimiento finito de esquemas afínes noetherianos.
\end{mydef}
Claramente, todo esquema noetheriano posee un espacio topológico noetheriano, pero el recíproco es falso:
para verlo puede notar que todo espacio topológico finito es trivialmente noetheriano y hay varios anillos no noetherianos con espectro finito.

\begin{prop}
	Un esquema $X$ es localmente noetheriano syss para todo abierto afín $U = \Spec A$ se cumple que $A$ es noetheriano.
	En particular, un esquema afín $\Spec A$ es localmente noetheriano syss $A$ es noetheriano.
\end{prop}
\begin{proof}
	$\impliedby$. Es trivial, puesto que los abiertos afínes son una base de cualquier esquema.

	$\implies$.
	Para ello basta verificar que la propiedad $\mathcal{P}$ de que el abierto afín $U$ sea tal que su anillo $\Gamma(U, \mathscr{O}_X)$ es noetheriano
	es local para afines.
	La propiedad LAf1 es trivial, puesto que si $A$ es noetheriano, entonces $A[1/f]$ también.
	% Sea $B$ un anillo noetheriano, entonces cada localización $B[1/f ]$ es noetheriana y $\DD(f) \cong \Spec(B[1/f ])$,
	% así que un esquema es localmente noetheriano syss posee una base de esquemas afínes dados por anillos noetherianos.

	% Nos reducimos a probar lo siguiente: un esquema afín $\Spec A$ es localmente noetheriano syss $A$ es noetheriano.
	% Sea $U \cong \Spec B$ con $B$ noetheriano y sea $f \in A$ tal que $\DD(f) \subseteq U $, entonces $A[1/f ] \cong B[1/f ]$ es noetheriano.
	% Así, podemos cubrir el $\Spec A$ con finitos $\{ \DD(f_i) \}^r_{i=1} $, lo que equivale a que $(f_1, \dots, f_r) = (1)$, tales que cada $A[1/f_i]$
	% es noetheriano.
	Probaremos LAf2: sea $\Spec A \subseteq X$ y sea $\Spec A = \bigcup_{i=1}^{n} \DD(f_i)$, donde cada $A[1/f_i]$ es noetheriano.
	Afirmamos que para todo ideal $\mathfrak{a} \nsle A$ se cumple
	$$ \mathfrak{a} = \bigcap_{i=1}^{r} \varphi_i^{-1}\big[ \varphi_i[\mathfrak{a}] \cdot A[1/f_i] \big], $$
	donde $\varphi_i \colon A \to A[1/f_i ]$ es el homomorfismo canónico.

	Si fijamos un $\varphi_i$, entonces vemos que la expresión $\varphi_i^{-1}\big[ \varphi_i[\mathfrak{a}] \cdot A[1/f_i] \big] = \mathfrak{a}^{ec} $,
	en notación de extensión y contracción de ideales, y siempre se cumple que $\mathfrak{a} \subseteq \mathfrak{a}^{ec}$ (cfr. \cite{Alg}, prop. 6.38).
	Veamos la inclusión <<$\supseteq$>>: Sea $b \in \bigcap_{i=1}^{r} \mathfrak{a}^{ec}$, es decir, para cada $i$ se cumple que $\varphi_i(b) = a_i/f_i^n$
	para algún $a_i \in \mathfrak{a}$ y algún $n \in N$ suficientemente grande.
	Esto equivale a que $f_i^m(f_i^nb - a_i) = 0$ para algún $m$ suficientemente grande, y como los $f_i$'s generan el 1, también los $f_i^N$'s
	con $N = n + m$, luego
	$$ b = \sum_{i=1}^{r} f_i^N g_i b = \sum_{i=1}^{r} a_i g_i f_i^m \in \mathfrak{a}. $$
	Ahora, dada una cadena de ideales $\mathfrak{a}_1 \subseteq \mathfrak{a}_2 \subseteq \cdots $, podemos extenderla
	mediante un homomorfismo $\varphi_i \colon A \to A[1/f_i]$:
	$$ \mathfrak{a}^e_1 \subseteq \mathfrak{a}^e_2 \subseteq \mathfrak{a}^e_3 \subseteq \cdots, $$
	y como $A[1/f_i]$ es noetheriano, entonces ésta cadena se estabiliza, dijamos en $n_i$.
	Eligiendo el máximo $n := \max\{ n_1, \dots , n_r\}$ vemos que la cadena en $A$ se estabiliza en dicho índice.

	Finalmente, concluimos por el lema de comunicación afín.
\end{proof}

% \begin{prop}
% 	Todo esquema localmente noetheriano tiene puntos cerrados.
% \end{prop}
